<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.302">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Eungwon Lee">

<title>Macroeconometrics Research Report - The Effect of Monetary Policy with Banks Deposit in Australia</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Macroeconometrics Research Report</span>
    </a>
  </div>
        <div class="quarto-navbar-tools ms-auto">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#the-objective-question-and-motivation" id="toc-the-objective-question-and-motivation" class="nav-link active" data-scroll-target="#the-objective-question-and-motivation">The objective, question, and motivation</a>
  <ul class="collapse">
  <li><a href="#objective" id="toc-objective" class="nav-link" data-scroll-target="#objective">Objective</a></li>
  <li><a href="#motivation" id="toc-motivation" class="nav-link" data-scroll-target="#motivation">Motivation</a></li>
  </ul></li>
  <li><a href="#data-and-their-properties" id="toc-data-and-their-properties" class="nav-link" data-scroll-target="#data-and-their-properties">Data and their properties</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1"></a></li>
  <li><a href="#section-2" id="toc-section-2" class="nav-link" data-scroll-target="#section-2"></a>
  <ul class="collapse">
  <li><a href="#integration-order-verification" id="toc-integration-order-verification" class="nav-link" data-scroll-target="#integration-order-verification">Integration order verification</a></li>
  </ul></li>
  <li><a href="#section-3" id="toc-section-3" class="nav-link" data-scroll-target="#section-3"></a></li>
  <li><a href="#the-model-and-hypothesis" id="toc-the-model-and-hypothesis" class="nav-link" data-scroll-target="#the-model-and-hypothesis">The model and hypothesis</a>
  <ul class="collapse">
  <li><a href="#the-model" id="toc-the-model" class="nav-link" data-scroll-target="#the-model">The model</a></li>
  <li><a href="#derivation" id="toc-derivation" class="nav-link" data-scroll-target="#derivation">Derivation</a></li>
  </ul></li>
  <li><a href="#hypothesis" id="toc-hypothesis" class="nav-link" data-scroll-target="#hypothesis">Hypothesis</a></li>
  <li><a href="#identiying-assumptions-case-1" id="toc-identiying-assumptions-case-1" class="nav-link" data-scroll-target="#identiying-assumptions-case-1">Identiying assumptions: case 1</a>
  <ul class="collapse">
  <li><a href="#the-prior-distibution" id="toc-the-prior-distibution" class="nav-link" data-scroll-target="#the-prior-distibution">The prior distibution</a></li>
  <li><a href="#the-posterior-distibution" id="toc-the-posterior-distibution" class="nav-link" data-scroll-target="#the-posterior-distibution">The posterior distibution</a></li>
  <li><a href="#empirical-investigation-for-baseline-model-case-1" id="toc-empirical-investigation-for-baseline-model-case-1" class="nav-link" data-scroll-target="#empirical-investigation-for-baseline-model-case-1">Empirical Investigation for baseline model (case 1)</a></li>
  </ul></li>
  <li><a href="#section-4" id="toc-section-4" class="nav-link" data-scroll-target="#section-4"></a></li>
  <li><a href="#identiying-assumptions-case-2long-run-restriction" id="toc-identiying-assumptions-case-2long-run-restriction" class="nav-link" data-scroll-target="#identiying-assumptions-case-2long-run-restriction">Identiying assumptions: case 2(Long-run restriction)</a>
  <ul class="collapse">
  <li><a href="#normalization-and-q-matrix" id="toc-normalization-and-q-matrix" class="nav-link" data-scroll-target="#normalization-and-q-matrix">Normalization and Q matrix</a></li>
  <li><a href="#empirical-investigation-for-model-with-long-run-restriction-case-2" id="toc-empirical-investigation-for-model-with-long-run-restriction-case-2" class="nav-link" data-scroll-target="#empirical-investigation-for-model-with-long-run-restriction-case-2">Empirical Investigation for model with long-run restriction (case 2)</a></li>
  </ul></li>
  <li><a href="#section-5" id="toc-section-5" class="nav-link" data-scroll-target="#section-5"></a></li>
  <li><a href="#identiying-assumptions-case-3-7-variables-without-deposit" id="toc-identiying-assumptions-case-3-7-variables-without-deposit" class="nav-link" data-scroll-target="#identiying-assumptions-case-3-7-variables-without-deposit">Identiying assumptions: case 3 (7 variables without deposit)</a>
  <ul class="collapse">
  <li><a href="#empirical-investigation-for-model-without-deposit-case-3" id="toc-empirical-investigation-for-model-without-deposit-case-3" class="nav-link" data-scroll-target="#empirical-investigation-for-model-without-deposit-case-3">Empirical Investigation for model without deposit (case 3)</a></li>
  </ul></li>
  <li><a href="#extension-1.-stochastic-volatility-heteroskedasticity" id="toc-extension-1.-stochastic-volatility-heteroskedasticity" class="nav-link" data-scroll-target="#extension-1.-stochastic-volatility-heteroskedasticity">Extension 1. Stochastic volatility heteroskedasticity</a>
  <ul class="collapse">
  <li><a href="#model-equations" id="toc-model-equations" class="nav-link" data-scroll-target="#model-equations">Model equations</a></li>
  <li><a href="#gibbs-sampler" id="toc-gibbs-sampler" class="nav-link" data-scroll-target="#gibbs-sampler">Gibbs sampler</a></li>
  <li><a href="#algorithm" id="toc-algorithm" class="nav-link" data-scroll-target="#algorithm">Algorithm</a></li>
  </ul></li>
  <li><a href="#extension-2.-estimation-of-hyperparameters" id="toc-extension-2.-estimation-of-hyperparameters" class="nav-link" data-scroll-target="#extension-2.-estimation-of-hyperparameters">Extension 2. Estimation of hyperparameters</a>
  <ul class="collapse">
  <li><a href="#derivation-1" id="toc-derivation-1" class="nav-link" data-scroll-target="#derivation-1">Derivation</a></li>
  </ul></li>
  <li><a href="#extension-3.-implementation-of-the-dummy-initial-observation" id="toc-extension-3.-implementation-of-the-dummy-initial-observation" class="nav-link" data-scroll-target="#extension-3.-implementation-of-the-dummy-initial-observation">Extension 3. Implementation of the dummy initial observation</a>
  <ul class="collapse">
  <li><a href="#empirical-investigation-for-extended-model" id="toc-empirical-investigation-for-extended-model" class="nav-link" data-scroll-target="#empirical-investigation-for-extended-model">Empirical Investigation for extended model</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">The Effect of Monetary Policy with Banks Deposit in Australia</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Eungwon Lee </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<blockquote class="blockquote">
<p><strong>Abstract.</strong> This research investigates the relationship between monetary policy, banks’ deposit, and credit in Australia. By incorporating the deposit channel in the analysis, it is found that changes in deposits play a role in transmitting monetary policy effects on credit and real economy. The study shows that credit and real GDP respond more sensitively to monetary policy shocks when deposits are included in the model. This finding emphasizes the importance of considering the deposit channel in understanding the impact of monetary policy on credit and other macro variables in Australia.</p>
</blockquote>
<blockquote class="blockquote">
<p><strong>Keywords.</strong> SVAR, monetary policy, credit, deposit</p>
</blockquote>
<section id="the-objective-question-and-motivation" class="level1">
<h1>The objective, question, and motivation</h1>
<section id="objective" class="level2">
<h2 class="anchored" data-anchor-id="objective">Objective</h2>
<p>The research objective is to investigate the relationship among monetary policy, banks deposit and credit growth, while considering other important macroeconomic variables in Australia, using a structural vector autoregression model. The overall question to be answered can thus be described as; How does the monetary policy and deposit growth affect the banks’ credit growth in Australia?</p>
</section>
<section id="motivation" class="level2">
<h2 class="anchored" data-anchor-id="motivation">Motivation</h2>
<p>The reason why the objective question is of interest is that banks’ credit plays an important role in the economy as it supports investment for firms, consumption for households, and sometimes causes inflationary pressure. Thus, the effect of monetary policy on credit has been deemed to be an important concern for researchers and central bankers. A channel that explains how monetary policy works through credit is called the credit channel. In the credit channel, changes in monetary policy affect the required reserves of banks, which cause banks to change the quantity of loans they provide (e.g., <span class="citation" data-cites="bernanke1992federal">Bernanke and Blinder (<a href="#ref-bernanke1992federal" role="doc-biblioref">1992</a>)</span>; <span class="citation" data-cites="jimenez2014hazardous">Gabriel Jiménez (<a href="#ref-jimenez2014hazardous" role="doc-biblioref">2014</a>)</span>). However, the effect of changes in reserves has been estimated to be too small to exert a meaningful influence on bank lending (<span class="citation" data-cites="woodford2010financial">Woodford (<a href="#ref-woodford2010financial" role="doc-biblioref">2010</a>)</span>).</p>
<p>One suggestion to fill this gap is proposed by <span class="citation" data-cites="drechsler2017deposits">Drechsler, Savov, and Schnabl (<a href="#ref-drechsler2017deposits" role="doc-biblioref">2017</a>)</span>. In the paper, they argue that banks’ credit substantially reacts to monetary policy through changes in deposits. According to their estimation, it accounts for the entire transmission of monetary policy through the bank’s balance sheet. I incorporate this deposit channel in the SVAR framework to evaluate the effect of monetary policy with deposit change on banks’ credit.</p>
</section>
</section>
<section id="data-and-their-properties" class="level1">
<h1>Data and their properties</h1>
<p>Following <span class="citation" data-cites="berkelmans2005credit">Berkelmans and Berkelmans (<a href="#ref-berkelmans2005credit" role="doc-biblioref">2005</a>)</span>, variables are largely divided into two groups: the external and domestic sectors. For the external sector, real commodity prices (such as oil prices) and real U.S. GDP are used. The domestic sector is captured by real Australian GDP, inflation rate, banks’ credit, deposit, US exchange rate, and cash rate.</p>
<p>At the moment, I load the related packages for the data work as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readrba)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readabs)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fredr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tseries)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(zoo)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xts)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FinTS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The external sector is included considering Australia’s status as a small open economy that heavily relies on foreign economic conditions. Commodity prices are included as they are known to capture the global business cycle that affects the domestic economy, and due to the fact that they usually ensure that the impulse responses does not show a price puzzle. The Index of Commodity Prices Australia (ICP) will be used for commodity prices. ICP is a measure of the average change in prices of Australia’s major export commodities over time using price data from a basket of commodities, including minerals, agricultural products, and energy resources. The ICP is a key indicator of Australia’s terms of trade. The inclusion of the U.S. GDP is also important as it has been Australia’s one of the major trading partners and the largest economy that influence the world economy heavily.</p>
<p>For the domestic sector, real GDP is included to capture the level of domestic economic activity, while the inflation rate is included as the Reserve Bank of Australia (RBA) has adopted an inflation target since 1990, which strongly affects monetary policy. Banks’ credit and deposit are key variables in the model as they form contemporaneous relationship with monetary policy. Finally, the cash rate is the primary tool of monetary policy for the RBA, and it is therefore an essential variable to include in the model.</p>
<p>Quarterly data between Q1 1990 and Q2 2019 was acquired from the Reserve Bank of Australia (RBA) and the Australian Bureau of Statistics (ABS) using the “readrba” and “readabs” packages in R. The data were mostly transformed into logarithmic form, except for exchange rate and cash rate, allowing the coefficients to be interpreted as elasticities. The exchange rate is presented AUD/USD, while the cash rate is presented in percentage.</p>
<p>Unfortunately, I cannot use data prior to Q1 1990 as RBA adopted the cash rate as its primary policy tool in the early 1990s, replacing the “interest rate on 90-day bills” as the target for monetary policy. Additionally, I cannot use data after Q2 2019 due to a break in the credit data at that time.</p>
<p>Below is how data look like. As we see below, stock and flow variables mostly have upward trend and it disappears when I take difference. Some variables such as GDP and deposit exhibit spark around 2020 as below.</p>
<section id="figure-1.-time-series-of-log-variables-from-1990-q1-to-2019-q2-except-usd-exchange-rate-and-cash-rate-is-not" class="level6" style="text-align: center;">
<h6 style="text-align: center;" class="anchored" data-anchor-id="figure-1.-time-series-of-log-variables-from-1990-q1-to-2019-q2-except-usd-exchange-rate-and-cash-rate-is-not">Figure 1. Time series of log variables from 1990 Q1 to 2019 Q2 except USD exchange rate and cash rate is not</h6>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="section" class="level1">
<h1></h1>
<p>Once we take the first difference between quarters, we observe that the trend disappears from most of the data. However, we still observe that first differenced banks credit and deposit seems to exhibit some trend. At the same time, we see that variances are still quite different across time in most of the variables.</p>
<section id="figure-2.-time-series-of-log-differenced-variables-from-1990-q1-to-2019-q2" class="level6" style="text-align: center;">
<h6 style="text-align: center;" class="anchored" data-anchor-id="figure-2.-time-series-of-log-differenced-variables-from-1990-q1-to-2019-q2">Figure 2. Time series of log differenced variables from 1990 Q1 to 2019 Q2</h6>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="section-1" class="level1">
<h1></h1>
<p>Autocorrelation Function (ACF) plots show the correlation between a time series and its lagged values. Stock variables such as credit and deposit exhibit the most strong correlation in time series while exchange rate and cash rate show relatively weak correlation between periods.</p>
<section id="figure-3.-autocorrelation-function-acf-plots-all-log-term-except-exchange-rate-and-cash-rate" class="level6" style="text-align: center;">
<h6 style="text-align: center;" class="anchored" data-anchor-id="figure-3.-autocorrelation-function-acf-plots-all-log-term-except-exchange-rate-and-cash-rate">Figure 3. Autocorrelation function (ACF) plots (all log term except exchange rate and cash rate)</h6>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/ACF plots-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="section-2" class="level1">
<h1></h1>
<p>The Partial Autocorrelation Function (PACF) is the correlation between a time series and a lagged version of itself, controlling for the values of the intermediate lags. The PACF plot shows the partial correlation coefficients between the time series and its lags. These coefficients represent the correlation between the time series and the lagged values of itself, with the effect of the intermediate lags removed. We see that for most of the variables, first lag is an important predictor of the current value of the time series.</p>
<section id="figure-4.-partial-autocorrelation-function-pacf-plots" class="level6" style="text-align: center;">
<h6 style="text-align: center;" class="anchored" data-anchor-id="figure-4.-partial-autocorrelation-function-pacf-plots">Figure 4. Partial Autocorrelation function (PACF) plots</h6>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/PACF plots-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="integration-order-verification" class="level2">
<h2 class="anchored" data-anchor-id="integration-order-verification">Integration order verification</h2>
<p>I conduct Augmented Dickey-Fuller test for log transformed variables and original cash rate and exchange rate using the “adf()” function to examines the presence of a unit root in the time series. The results of the test are displayed in the table below. Across all variables except exchange rate, I cannot not reject the null hypothesis of unit root. It indicates that the time series is non-stationary and requires differencing to achieve stationarity.</p>
<section id="table-1.-augmented-dickey-fuller-test-for-log-transformed-variables-except-ex_rate-and-cash-rate" class="level6" style="text-align: center;">
<h6 style="text-align: center;" class="anchored" data-anchor-id="table-1.-augmented-dickey-fuller-test-for-log-transformed-variables-except-ex_rate-and-cash-rate">Table 1. Augmented Dickey-Fuller test for log transformed variables except ex_rate and cash rate</h6>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>                  Test statistic P-value Lags
Commodity price           -2.040   0.560    4
US real GDP               -1.904   0.616    4
AU Real GDP               -0.506   0.980    4
CPI                       -2.276   0.462    4
Cash rate                 -4.990   0.010    4
Banks' deposit            -1.811   0.655    4
Banks' credit             -1.599   0.743    4
USD exchange rate         -1.717   0.694    4</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="section-3" class="level1">
<h1></h1>
<p>Then I conduct Augmented Dickey-Fuller test for first differenced log transformed variables and original cash rate and exchange rate using the “adf()” function to examines the presence of a unit root in the differenced time series. The results of the test are displayed in the table below. As we can expect, most of variables except banks’ deposit and credit, P-values of the tests are below 5% or 1%, implying the rejection of null hypothesis of unit root.</p>
<section id="table-2.-augmented-dickey-fuller-test-for-quarter-on-quarter-differenced-variables" class="level6" style="text-align: center;">
<h6 style="text-align: center;" class="anchored" data-anchor-id="table-2.-augmented-dickey-fuller-test-for-quarter-on-quarter-differenced-variables">Table 2. Augmented Dickey-Fuller test for quarter on quarter differenced variables</h6>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>                  Test statistic P-value Lags
Commodity price           -5.813   0.010    4
US real GDP               -4.382   0.010    4
AU Real GDP               -5.484   0.010    4
CPI                       -3.882   0.017    4
Cash rate                 -4.482   0.010    4
Banks' deposit            -3.082   0.128    4
Banks' credit             -2.538   0.353    4
USD exchange rate         -4.585   0.010    4</code></pre>
</div>
</div>
<p>This raises the issue of the appropriate estimation methodology. Some papers (i.g. Berkelmans, 2005) estimate SVAR in levels even when the variables are I(1) while others (Siami-Namini, 2016) use first differences in their model.</p>
</section>
</section>
<section id="the-model-and-hypothesis" class="level1">
<h1>The model and hypothesis</h1>
<section id="the-model" class="level2">
<h2 class="anchored" data-anchor-id="the-model">The model</h2>
<p>The structural VAR model with <span class="math inline">\(4\)</span> lags is given by</p>
<p><span class="math display">\[
\begin{align}
  B_0y_t &amp;= b_0 + B_1 y_{t-1} + \dots + B_4 y_{t-4} + u_t \\
  u_{t}| Y_{t-1} &amp;\sim {iid} ( 0_N, I_N)
\end{align}
\]</span> Where <span class="math inline">\(B_0\)</span> is a matrix of contemporaneous relationships, <span class="math inline">\(y_t\)</span> is a vector of endogenous variables, <span class="math inline">\(y_{t-1}\)</span>, <span class="math inline">\(\dots\)</span>, <span class="math inline">\(y_{t-1}\)</span> are vectors of lags, and <span class="math inline">\(u_t\)</span> is a vector of independent structural shocks.</p>
<p><span class="math inline">\(y_t\)</span> contains eight variables: commodity prices (<span class="math inline">\(com_t\)</span>), the U.S. real GDP (<span class="math inline">\(usgdp_t\)</span>), domestic real GDP (<span class="math inline">\(gdp_t\)</span>), inflation rate(<span class="math inline">\(\pi_t\)</span>), cash rate (<span class="math inline">\(i_t\)</span>), banks’ deposit(<span class="math inline">\(d_t\)</span>), banks’ credit(<span class="math inline">\(c_t\)</span>), and USD exchange rate (<span class="math inline">\(ex_t\)</span>).</p>
<p>Premultiplying <span class="math inline">\(B_0^{-1}\)</span> to the structural VAR model gives us the reduced form representation as follows:</p>
<p><span class="math display">\[
\begin{align*}
  y_t &amp;= \mu_0 + A_1 y_{t-1} + \dots + A_4 y_{t-4} + \epsilon_t \\
  \epsilon_{t}| Y_{t-1} &amp;\sim {iid} ( 0_N, \Sigma)
\end{align*}
\]</span> where <span class="math inline">\(A_i=B_0^{-1}B_i\)</span>, <span class="math inline">\(\epsilon_t=B_0^{-1}u_t\)</span>, and <span class="math inline">\(\Sigma=\)</span><span class="math inline">\(B_0^{-1}B_0^{-1 \prime}\)</span></p>
<p>Using the reduced form equations, we can estimate <span class="math inline">\(\Sigma\)</span>. However <span class="math inline">\(\Sigma\)</span> has <span class="math inline">\(8(8+1)/2=36\)</span> unique elements, which is the number of equations, yet we have <span class="math inline">\(8^2=64\)</span> unknowns in <span class="math inline">\(B_0\)</span>. Hence I impose exclusion restrictions on <span class="math inline">\(B_0\)</span> to identify the system.</p>
</section>
<section id="derivation" class="level2">
<h2 class="anchored" data-anchor-id="derivation">Derivation</h2>
<p><span class="math display">\[
\begin{align*}
Y   &amp;= XA + E \\
E|X &amp;\sim \mathcal{MN}_{T \times N}(0_{T \times N},\Sigma,I_T) \\
L(A,\Sigma|Y,X) &amp;\propto det(\Sigma)^{-\frac{T}{2}} exp \left\{-\frac{1}{2} tr \left[ \Sigma^{-1}(Y-XA)'(Y-XA) \right] \right\} \\
                &amp;= det(\Sigma)^{-\frac{T}{2}} exp \left\{-\frac{1}{2} tr \left[ \Sigma^{-1}(A-\hat{A})'X'X(A-\hat{A}) \right] \right\} exp \left\{-\frac{1}{2} tr \left[\Sigma^{-1}(Y-X \hat{A})'(Y-X \hat{A}) \right] \right\} \\
\end{align*}
\]</span></p>
<p>where <span class="math inline">\(\hat{A} = (X'X)^{-1}X'Y\)</span> and it follows that</p>
<p><span class="math display">\[
\begin{align*}
L(A,\Sigma|Y,X) = \mathcal{NIW}_{K\times N}(\hat{A}, \quad (X'X)^{-1},  \quad (Y-X\hat{A})'(Y-X\hat{A}),  \quad T-N-K)
\end{align*}
\]</span></p>
<p>The joint prior distribution for <span class="math inline">\((A, \Sigma)\)</span> of the same form is as follows:</p>
<p><span class="math display">\[
\begin{align*}
p(A,\Sigma) &amp;= p(A|\Sigma) p(\Sigma) \\
A|\Sigma &amp;\sim \mathcal{MN}_{K \times N} (\underline{A}, \Sigma , \underline{V}) \\
\Sigma &amp;\sim \mathcal{IW}_{N}(\underline{S},\underline{\nu})
\end{align*}
\]</span></p>
<p>And the full conditional posterior is followed by:</p>
<p><span class="math display">\[
\begin{align*}
p(A,\Sigma |Y, X) &amp;= p(A|Y, X, \Sigma) p(\Sigma|Y,X) \\
p(A|Y,X,\Sigma)   &amp;= \mathcal{MN}_{K \times N} (\bar{A}, \Sigma , \bar{V}) \\
p(\Sigma|Y, X)    &amp;= \mathcal{IW}_{N}(\bar{S},\bar{\nu})
\end{align*}
\]</span></p>
<p>The posterior parameters are given by:</p>
<p><span class="math display">\[
\begin{align*}
\bar{V}      &amp;= (X'X+ \underline{V}^{-1})^{-1} \\
   \bar{A}   &amp;= \bar{V}(X'Y+\underline{V}^{-1} \underline{A}) \\
   \bar{\nu} &amp;= T + \underline{\nu} \\
   \bar{S}   &amp;= \underline{S} + Y'Y + \underline{A}'\underline{V}^{-1}\underline{A} - \bar{A}'\bar{V}^{-1}\bar{A}
\end{align*}
\]</span></p>
</section>
</section>
<section id="hypothesis" class="level1">
<h1>Hypothesis</h1>
<p>I want to estimate how monetary shocks affect credit while controlling for deposits. I expect that credit will be less responsive to monetary policy when deposits are included as an endogenous variable. This expectation is consistent with the deposit channel of monetary policy, where banks’ credit is heavily influenced by changes in deposits in response to monetary policy.</p>
</section>
<section id="identiying-assumptions-case-1" class="level1">
<h1>Identiying assumptions: case 1</h1>
<p>In this case, I apply a lower triangular matrix to <span class="math inline">\(B_0\)</span> matrix.</p>
<p>Assumptions for <span class="math inline">\(B_0\)</span> matrix is as follows:</p>
<ul>
<li>Since Australian economy is a small open economy, I assume that the domestic variables have no effect on external variables while shocks from the external sector have simultaneous effect on the domestic economy.</li>
<li>GDP is affected from the external sector but not affected by other domestic variables contemporaneously</li>
<li>Inflation is affected from the external sector and GDP but not affected by other domestic variables contemporaneously.</li>
<li>Cash rate is affected from the external sector, GDP and inflation but not affected by other domestic variables contemporaneously.</li>
<li>Deposit is affected from the external sector, GDP, inflation, and cash rate but not affected by other domestic variables contemporaneously. I assume that profit maximization motive makes banks to adjust the deposit rate at the same period that RBA adjusts the cash rate. And deposit volume changes accordingly.</li>
<li>Credit is affected from the external sector, GDP, inflation, cash rate, and deposit but not affected by other domestic variables contemporaneously. Since the deposit is the most stable and major funding source for banks, I assume that banks reduces credit outstanding in response to deposit change.</li>
<li>The exchange rate is affected from all variables contemporaneously.</li>
</ul>
<p>Following equation summarizes the contemporaneous relationships among the variables:</p>
<p><span class="math display">\[
B_0y_t =
\begin{bmatrix}
a_{11} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
a_{21} &amp; a_{22} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
a_{31} &amp; a_{32} &amp; a_{33} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
a_{41} &amp; a_{42} &amp; a_{43} &amp; a_{44} &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
a_{51} &amp; a_{52} &amp; a_{53} &amp; a_{54} &amp; a_{55} &amp; 0 &amp; 0 &amp; 0 \\
a_{61} &amp; a_{62} &amp; a_{63} &amp; a_{64} &amp; a_{65} &amp; a_{66} &amp; 0 &amp; 0 \\
a_{71} &amp; a_{72} &amp; a_{73} &amp; a_{74} &amp; a_{75} &amp; a_{76} &amp; a_{77} &amp; 0 \\
a_{81} &amp; a_{82} &amp; a_{83} &amp; a_{84} &amp; a_{85} &amp; a_{86} &amp; a_{87} &amp; a_{88} \\
\end{bmatrix}
\begin{bmatrix}
com_t \\
usgdp_t \\
gdp_t \\
\pi_t \\
i_t \\
deposit_t \\
credit_t \\
ex_t \\
\end{bmatrix}
\]</span></p>
<p>Note that this assumption and thus order of the variables in <span class="math inline">\(y_t\)</span> is subject to change over the course of the research upon any better identifying assumptions. One problem that arises from using quarterly data instead of monthly is difficulty of setting identifying assumptions. When it is monthly data, we can utilize the assumption of informational delay. When deciding on monetary policy in the Australian economy, RBA takes into consideration a range of variables including, but are not limited to, CPI and GDP. However, due to informational delay, CPI, GDP, and other relevant variables may not be immediately available to the monetary authorities. This allows us to claim no contemporaneous relation between policy rate and some variables. This is difficult to argue in quarterly data since a quarter may be enough time to have contemporaneous relation between policy rate and some other variables.</p>
<section id="the-prior-distibution" class="level2">
<h2 class="anchored" data-anchor-id="the-prior-distibution">The prior distibution</h2>
<p>The prior parameters are set as follows: <span class="math inline">\(\kappa_1\)</span>, which is the overall shrinkage parameter to control the dispersion around the prior mean, is set to 1. <span class="math inline">\(\kappa_2\)</span>, the overall shrinkage for the constant term, is set to 100. <span class="math inline">\(\kappa_3\)</span> is set to 1.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters for prior distribution </span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="do">############################################################</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>kappa<span class="fl">.1</span>        <span class="ot">=</span> <span class="dv">1</span><span class="sc">^</span><span class="dv">2</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>kappa<span class="fl">.2</span>        <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>kappa<span class="fl">.3</span>        <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>A.prior        <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="fu">nrow</span>(A.hat),<span class="fu">ncol</span>(A.hat))</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>A.prior[<span class="dv">2</span><span class="sc">:</span><span class="dv">9</span>,]  <span class="ot">=</span> kappa<span class="fl">.3</span><span class="sc">*</span><span class="fu">diag</span>(N)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>V.prior        <span class="ot">=</span> <span class="fu">diag</span>(<span class="fu">c</span>(kappa<span class="fl">.2</span>,kappa<span class="fl">.1</span><span class="sc">*</span>((<span class="dv">1</span><span class="sc">:</span>p)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">2</span>))<span class="sc">%x%</span><span class="fu">rep</span>(<span class="dv">1</span>,N)))</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>S.prior        <span class="ot">=</span> <span class="fu">diag</span>(<span class="fu">diag</span>(Sigma.hat))</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>nu.prior       <span class="ot">=</span> N<span class="sc">+</span><span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="the-posterior-distibution" class="level2">
<h2 class="anchored" data-anchor-id="the-posterior-distibution">The posterior distibution</h2>
<p>Using the likelihood and the prior distribution I obtain the posterior as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># normal-inverse Wishard posterior parameters</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="do">############################################################</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>V.bar.inv   <span class="ot">=</span> <span class="fu">t</span>(X)<span class="sc">%*%</span>X <span class="sc">+</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(V.prior))</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>V.bar       <span class="ot">=</span> <span class="fu">solve</span>(V.bar.inv)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>A.bar       <span class="ot">=</span> V.bar<span class="sc">%*%</span>(<span class="fu">t</span>(X)<span class="sc">%*%</span>Y <span class="sc">+</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(V.prior))<span class="sc">%*%</span>A.prior)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>nu.bar      <span class="ot">=</span> <span class="fu">nrow</span>(Y) <span class="sc">+</span> nu.prior</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>S.bar       <span class="ot">=</span> S.prior <span class="sc">+</span> <span class="fu">t</span>(Y)<span class="sc">%*%</span>Y <span class="sc">+</span> <span class="fu">t</span>(A.prior)<span class="sc">%*%</span><span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(V.prior))<span class="sc">%*%</span>A.prior <span class="sc">-</span> <span class="fu">t</span>(A.bar)<span class="sc">%*%</span>V.bar.inv<span class="sc">%*%</span>A.bar</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>S.bar.inv   <span class="ot">=</span> <span class="fu">solve</span>(S.bar)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># posterior draws </span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="do">############################################################</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>Sigma.posterior   <span class="ot">=</span> <span class="fu">rWishart</span>(S, <span class="at">df=</span>nu.bar, <span class="at">Sigma=</span>S.bar.inv)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>Sigma.posterior   <span class="ot">=</span> <span class="fu">apply</span>(Sigma.posterior,<span class="dv">3</span>,solve)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>Sigma.posterior   <span class="ot">=</span> <span class="fu">array</span>(Sigma.posterior,<span class="fu">c</span>(N,N,S))</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>A.posterior       <span class="ot">=</span> <span class="fu">array</span>(<span class="fu">rnorm</span>(<span class="fu">prod</span>(<span class="fu">c</span>(<span class="fu">dim</span>(A.bar),S))),<span class="fu">c</span>(<span class="fu">dim</span>(A.bar),S))</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>B.posterior       <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(N,N,S))</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>L                 <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">chol</span>(V.bar))</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>S){</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  cholSigma.s     <span class="ot">=</span> <span class="fu">chol</span>(Sigma.posterior[,,s])</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  B.posterior[,,s]<span class="ot">=</span> <span class="fu">t</span>(cholSigma.s)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  A.posterior[,,s]<span class="ot">=</span> A.bar <span class="sc">+</span> L<span class="sc">%*%</span>A.posterior[,,s]<span class="sc">%*%</span>cholSigma.s</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="empirical-investigation-for-baseline-model-case-1" class="level2">
<h2 class="anchored" data-anchor-id="empirical-investigation-for-baseline-model-case-1">Empirical Investigation for baseline model (case 1)</h2>
<p>As we see the Impulse Response Functions (IRFs) below, upon a cash rate shock, Australian real GDP decreases for more than a year and the impact statistically becomes zero in a longer term, deposit increases for nearly two years and then the impact becomes statistically zero in a longer term, price increases and then the effect gradually becomes zero, credit, which is the variable of my interest, increases in the short term for about a year and then decreases and the effect becomes statistically zero, and exchange rate increases shortly and then becomes statistically indistinguishable from zero.</p>
<section id="figure-5.-irf-to-cash-rate-shock-for-kappa_1-1-plots" class="level6" style="text-align: center;">
<h6 style="text-align: center;" class="anchored" data-anchor-id="figure-5.-irf-to-cash-rate-shock-for-kappa_1-1-plots">Figure 5. IRF to cash rate shock for <span class="math inline">\(\kappa_1\)</span> = 1 plots</h6>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/irf-au-mps plots-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="section-4" class="level1">
<h1></h1>
<p>The contribution of the shocks to the mean square forecast error (MSFE) of the credit for 10 quarters ahead is given below. Specifically, it provides a sense of the relative importance of shocks in explaining the forecast variability of credit quantifying the percentage of the forecast error variance of credit that can be attributed to its own shocks and the shocks of other variables such as cash rate. Initially, its own shock contribute the most of the variance. However, as it proceeds, the role of its own shock shrinks considerably while other variables, especially cash rate (mps in the figure) explains much more of the variance as time goes by.</p>
<section id="figure-6.-fevd-of-banks-credit-plots" class="level6" style="text-align: center;">
<h6 style="text-align: center;" class="anchored" data-anchor-id="figure-6.-fevd-of-banks-credit-plots">Figure 6. FEVD of banks’ credit plots</h6>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/fevd-credit plots-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="identiying-assumptions-case-2long-run-restriction" class="level1">
<h1>Identiying assumptions: case 2(Long-run restriction)</h1>
<p>In case 2, I additionally apply a long-run restriction to the baseline model (case 1 model). The restriction that I additionally impose is that monetary policy has no effect on the Australian real GDP in the long run. Since the algorithm (Algorithm 1 in lecture 13) I use works only for exactly identified models, the restrictions of interest to be imposed on the system must exactly identify the model. Hence, to make a room for a long-run restriction, I allow monetary policy to have an effect on the Australian real GDP contemporaneously and then I impose a restriction that the monetary policy has no effect on the Australian real GDP in the long run.</p>
<p>Following equation summarizes the restrictions I impose for IRFs on horizons 0 and <span class="math inline">\(\infty\)</span>:</p>
<p><span class="math display">\[
\begin{align*}
\Theta_0 = B = B_0^{-1} &amp;=
\begin{bmatrix}
* &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
* &amp; * &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
* &amp; * &amp; * &amp; 0 &amp; * &amp; 0 &amp; 0 &amp; 0 \\
* &amp; * &amp; * &amp; * &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
* &amp; * &amp; * &amp; * &amp; * &amp; 0 &amp; 0 &amp; 0 \\
* &amp; * &amp; * &amp; * &amp; * &amp; * &amp; 0 &amp; 0 \\
* &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * &amp; 0 \\
* &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * \\
\end{bmatrix}
\\
\Theta_{\infty} = (B_0-B_1-B_2-B_3-B_4)^{-1} &amp;=
\begin{bmatrix}
* &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * \\
* &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * \\
* &amp; * &amp; * &amp; * &amp; 0 &amp; * &amp; * &amp; * \\
* &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * \\
* &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * \\
* &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * \\
* &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * \\
* &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * \\
\end{bmatrix}
\end{align*}
\]</span></p>
<p>Where the structural form model is <span class="math inline">\(QB_0y_t=Qb_0+QB_1y_{t-1}+QB_2y_{t-2}+QB_3y_{t-3}+QB_3y_{t-4}+Qu_t, \quad u_t|Y_{t-1} \sim iid(0_8, I_8)\)</span></p>
<section id="normalization-and-q-matrix" class="level2">
<h2 class="anchored" data-anchor-id="normalization-and-q-matrix">Normalization and Q matrix</h2>
<p>To apply a long-run restriction, I need a rotation matrix for it. Obtaining the rotation matrix under the algorithm in Rubio-Ramírez, Waggoner &amp; Zha (2010) requires a contemporaneous relationship matrix <span class="math inline">\(B_0\)</span> such that the number of restrictions in each column is weakly decreasing from the left to the right. Thus, I transpose the contemporaneous relationship matrix <span class="math inline">\(B_0\)</span> as follows:</p>
<p><span class="math display">\[
\begin{align*}
B_0' &amp;=
\begin{bmatrix}
* &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * \\
0 &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * \\
0 &amp; 0 &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * \\
0 &amp; 0 &amp; 0 &amp; * &amp; * &amp; * &amp; * &amp; * \\
0 &amp; 0 &amp; * &amp; 0 &amp; * &amp; * &amp; * &amp; * \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; * &amp; * &amp; * \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; * &amp; * \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; * \\
\end{bmatrix}
\\
\Theta_{\infty}' = (B_0-B_1-B_2-B_3-B_4)' &amp;=
\begin{bmatrix}
* &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * \\
* &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * \\
* &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * \\
* &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * \\
* &amp; * &amp; 0 &amp; * &amp; * &amp; * &amp; * &amp; * \\
* &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * \\
* &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * \\
* &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * &amp; * \\
\end{bmatrix}
\end{align*}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial setup</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>S){</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>B0.posterior.tilde[,,s]       <span class="ot">=</span> <span class="fu">solve</span>(B.posterior[,,s])</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>Bplus.posterior.tilde[,,s]    <span class="ot">=</span> B0.posterior.tilde[,,s]<span class="sc">%*%</span><span class="fu">t</span>(A.posterior[,,s])</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># transpose so that the ranks of restrictions are in descending order.</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>S){</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>B0.posterior.transposed.tilde[,,s]      <span class="ot">=</span> <span class="fu">t</span>(B0.posterior.tilde[,,s])</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>IR.infinity.transposed.tilde[,,s]       <span class="ot">=</span> <span class="fu">t</span>(B0.posterior.tilde[,,s]<span class="sc">-</span>Bplus.posterior.tilde[,<span class="dv">2</span><span class="sc">:</span><span class="dv">9</span>,s]<span class="sc">-</span>Bplus.posterior.tilde[,<span class="dv">10</span><span class="sc">:</span><span class="dv">17</span>,s]<span class="sc">-</span>Bplus.posterior.tilde[,<span class="dv">18</span><span class="sc">:</span><span class="dv">25</span>,s]<span class="sc">-</span>Bplus.posterior.tilde[,<span class="dv">26</span><span class="sc">:</span><span class="dv">33</span>,s])</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Orthogonal complement matrix</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="do">############################################################</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>orthogonal.complement.matrix.TW <span class="ot">=</span> <span class="cf">function</span>(x){</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># x is a mxn matrix and m&gt;n</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the function returns a mx(m-n) matrix, out, that is an orthogonal complement of x, i.e.:</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># t(x)%*%out = 0 and det(cbind(x,out))!=0</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  NN     <span class="ot">=</span> <span class="fu">dim</span>(x)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  tmp   <span class="ot">=</span> <span class="fu">qr.Q</span>(<span class="fu">qr</span>(x, <span class="at">tol =</span> <span class="fl">1e-10</span>),<span class="at">complete=</span><span class="cn">TRUE</span>)</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  out   <span class="ot">=</span> <span class="fu">as.matrix</span>(tmp[,(NN[<span class="dv">2</span>]<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>NN[<span class="dv">1</span>]])</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Use Algorithm 1 to obtain Q</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a><span class="do">############################################################</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>R1 <span class="ot">=</span> <span class="fu">cbind</span>(<span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">7</span>,<span class="dv">1</span>), <span class="fu">diag</span>(<span class="dv">7</span>), <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">7</span>,<span class="dv">8</span>))</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>R2 <span class="ot">=</span> <span class="fu">cbind</span>(<span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">6</span>,<span class="dv">2</span>), <span class="fu">diag</span>(<span class="dv">6</span>), <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">6</span>,<span class="dv">8</span>))</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>R3 <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="dv">5</span>,<span class="dv">16</span>)</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>R3[<span class="dv">1</span>,<span class="dv">4</span>] <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>R3[<span class="dv">2</span>,<span class="dv">6</span>] <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>R3[<span class="dv">3</span>,<span class="dv">7</span>] <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>R3[<span class="dv">4</span>,<span class="dv">8</span>] <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>R3[<span class="dv">5</span>,<span class="dv">13</span>] <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>R4 <span class="ot">=</span> <span class="fu">cbind</span>(<span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">4</span>), <span class="fu">diag</span>(<span class="dv">4</span>), <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">8</span>))</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>R5 <span class="ot">=</span> <span class="fu">cbind</span>(<span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">5</span>), <span class="fu">diag</span>(<span class="dv">3</span>), <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">8</span>))</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>R6 <span class="ot">=</span> <span class="fu">cbind</span>(<span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">6</span>), <span class="fu">diag</span>(<span class="dv">2</span>), <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">8</span>))</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>R7 <span class="ot">=</span> <span class="fu">cbind</span>(<span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">7</span>), <span class="fu">diag</span>(<span class="dv">1</span>), <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">8</span>))</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>S){</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>fAA             <span class="ot">=</span> <span class="fu">rbind</span>(B0.posterior.transposed.tilde[,,s],IR.infinity.transposed.tilde[,,s])</span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>p1.s            <span class="ot">=</span> <span class="fu">orthogonal.complement.matrix.TW</span>(<span class="fu">t</span>(R1 <span class="sc">%*%</span> fAA))</span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>p2.s            <span class="ot">=</span> <span class="fu">orthogonal.complement.matrix.TW</span>(<span class="fu">cbind</span>(<span class="fu">t</span>(R2 <span class="sc">%*%</span> fAA),p1.s))</span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>p3.s            <span class="ot">=</span> <span class="fu">orthogonal.complement.matrix.TW</span>(<span class="fu">cbind</span>(<span class="fu">t</span>(R3 <span class="sc">%*%</span> fAA),p1.s,p2.s))</span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>p4.s            <span class="ot">=</span> <span class="fu">orthogonal.complement.matrix.TW</span>(<span class="fu">cbind</span>(<span class="fu">t</span>(R4 <span class="sc">%*%</span> fAA),p1.s,p2.s,p3.s))</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>p5.s            <span class="ot">=</span> <span class="fu">orthogonal.complement.matrix.TW</span>(<span class="fu">cbind</span>(<span class="fu">t</span>(R5 <span class="sc">%*%</span> fAA),p1.s,p2.s,p3.s,p4.s))</span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>p6.s            <span class="ot">=</span> <span class="fu">orthogonal.complement.matrix.TW</span>(<span class="fu">cbind</span>(<span class="fu">t</span>(R6 <span class="sc">%*%</span> fAA),p1.s,p2.s,p3.s,p4.s,p5.s))</span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>p7.s            <span class="ot">=</span> <span class="fu">orthogonal.complement.matrix.TW</span>(<span class="fu">cbind</span>(<span class="fu">t</span>(R7 <span class="sc">%*%</span> fAA),p1.s,p2.s,p3.s,p4.s,p5.s,p6.s))</span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>p8.s            <span class="ot">=</span> <span class="fu">orthogonal.complement.matrix.TW</span>(<span class="fu">cbind</span>(p1.s,p2.s,p3.s,p4.s,p5.s,p6.s,p7.s))</span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>Q[,,s]            <span class="ot">=</span> <span class="fu">cbind</span>(p1.s,p2.s,p3.s,p4.s,p5.s,p6.s,p7.s,p8.s)</span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>B0.posterior[,,s]    <span class="ot">=</span> Q[,,s]<span class="sc">%*%</span>B0.posterior.tilde[,,s]</span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>Bplus.posterior[,,s] <span class="ot">=</span> Q[,,s]<span class="sc">%*%</span>Bplus.posterior.tilde[,,s]  <span class="do">######!!@@@</span></span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>IR.infinity[,,s]     <span class="ot">=</span> <span class="fu">solve</span>(B0.posterior[,,s]<span class="sc">-</span>Bplus.posterior[,<span class="dv">2</span><span class="sc">:</span><span class="dv">9</span>,s]<span class="sc">-</span>Bplus.posterior[,<span class="dv">10</span><span class="sc">:</span><span class="dv">17</span>,s]<span class="sc">-</span>Bplus.posterior[,<span class="dv">18</span><span class="sc">:</span><span class="dv">25</span>,s]<span class="sc">-</span>Bplus.posterior[,<span class="dv">26</span><span class="sc">:</span><span class="dv">33</span>,s])</span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The posterior <span class="math inline">\(B_0\)</span> matrix requires a normalization since it exhibits symmetric distribution round zero. Below is the normalization function for this.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># initial setup</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># create diag.signs matrix</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#1.Function to convert decimal to binary with leading zeros</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>decimal_to_binary <span class="ot">&lt;-</span> <span class="cf">function</span>(decimal, length) {</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  binary <span class="ot">&lt;-</span> <span class="fu">numeric</span>(length)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> length<span class="sc">:</span><span class="dv">1</span>) {</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    binary[i] <span class="ot">&lt;-</span> decimal <span class="sc">%%</span> <span class="dv">2</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    decimal <span class="ot">&lt;-</span> decimal <span class="sc">%/%</span> <span class="dv">2</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(binary)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 2.Generate the matrix with 256 rows and 8 columns</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>diag.signs <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">256</span>, <span class="at">ncol =</span> <span class="dv">8</span>)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 3.Populate the matrix with unique combinations of -1 and 1</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">255</span>) {</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  binary <span class="ot">&lt;-</span> <span class="fu">decimal_to_binary</span>(i, <span class="dv">8</span>)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  binary[binary <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  diag.signs[i <span class="sc">+</span> <span class="dv">1</span>, ] <span class="ot">&lt;-</span> binary</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Function</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>normalization.wz2003  <span class="ot">=</span> <span class="cf">function</span>(B0.posterior.tmp,B0.posterior.hat.inv, Sigma.posterior.inv, diag.signs){</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This function normalizes a matrix of contemporaneous effects</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># according to the algorithm by Waggoner &amp; Zha (2003, JOE)</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># B0        - an NxN matrix, to be normalized</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># B0.hat    - an NxN matrix, a normalized matrix</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>  N                 <span class="ot">=</span> <span class="fu">nrow</span>(B0.posterior.tmp)</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>  K                 <span class="ot">=</span> <span class="dv">2</span><span class="sc">^</span>N</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>  distance          <span class="ot">=</span> <span class="fu">rep</span>(<span class="cn">NA</span>,K)</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K){</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>    B0.tmp.inv      <span class="ot">=</span> <span class="fu">solve</span>(<span class="fu">diag</span>(diag.signs[k,]) <span class="sc">%*%</span> B0.posterior.tmp)</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>    distance[k]     <span class="ot">=</span> <span class="fu">sum</span>(</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>      <span class="fu">unlist</span>(</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>        <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N,</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>               <span class="cf">function</span>(n){</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">t</span>(B0.tmp.inv <span class="sc">-</span> B0.posterior.hat.inv)[n,] <span class="sc">%*%</span>Sigma.posterior.inv <span class="sc">%*%</span> <span class="fu">t</span>(B0.tmp.inv <span class="sc">-</span> B0.posterior.hat.inv)[n,]</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>               }</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>        )))</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>  B0.out            <span class="ot">=</span> <span class="fu">diag</span>(diag.signs[<span class="fu">which.min</span>(distance),]) <span class="sc">%*%</span> B0.posterior.tmp</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(B0.out)</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a><span class="co">#Obtain normalized B0</span></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>t0<span class="ot">=</span>  <span class="fu">proc.time</span>()</span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>ttt<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>B0.posterior.hat.inv <span class="ot">=</span> <span class="fu">solve</span>(B0.posterior[,,<span class="dv">1</span>]) <span class="co"># does - reverse the IRF?</span></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>S){</span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>Sigma.posterior.inv <span class="ot">=</span> <span class="fu">solve</span>(Sigma.posterior[,,s])</span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>B0.posterior.tmp    <span class="ot">=</span> B0.posterior[,,s]</span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>B0.posterior.norm[,,s] <span class="ot">=</span> <span class="fu">normalization.wz2003</span>(B0.posterior.tmp,B0.posterior.hat.inv, Sigma.posterior.inv, diag.signs)</span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>ttt<span class="ot">=</span>ttt<span class="sc">+</span>s<span class="sc">/</span>s</span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>t1          <span class="ot">=</span> <span class="fu">proc.time</span>()</span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>(t1<span class="sc">-</span>t0)[<span class="dv">3</span>]<span class="sc">/</span><span class="dv">60</span> <span class="co"># Time of computations in minutes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>elapsed 
 3.2985 </code></pre>
</div>
</div>
</section>
<section id="empirical-investigation-for-model-with-long-run-restriction-case-2" class="level2">
<h2 class="anchored" data-anchor-id="empirical-investigation-for-model-with-long-run-restriction-case-2">Empirical Investigation for model with long-run restriction (case 2)</h2>
<p>Unlike the baseline model, the relationship between Australian real GDP and cash rate in the long-run is restricted such that there cash rate has no effect on Australian real GDP. Though this alternative restriction, I expect that the result would not be quite different from the result of the baseline model. This is because if I look at the IRF of Australian real GDP to cash rate, the effect is not different from zero statistically.</p>
</section>
</section>
<section id="section-5" class="level1">
<h1></h1>
<p>Below is IRF with long-run restiction and normalization.Though the point estimations deviate from zero but most of the confident intervals of variables include zero except real GDP which decrease but it gets to zero statistically as time proceeds.</p>
<section id="figure-7.-irf-to-cash-rate-shock-with-long-run-restiction-and-normalization" class="level6" style="text-align: center;">
<h6 style="text-align: center;" class="anchored" data-anchor-id="figure-7.-irf-to-cash-rate-shock-with-long-run-restiction-and-normalization">Figure 7. IRF to cash rate shock with long-run restiction and normalization</h6>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/irf-au-mps plots3_normalized-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="identiying-assumptions-case-3-7-variables-without-deposit" class="level1">
<h1>Identiying assumptions: case 3 (7 variables without deposit)</h1>
<p>In case 3, I shut down the deposit channel to see how banks’ credit respond upon cash rate shock. Following equation summarizes the contemporaneous relationships among the variables in this case:</p>
<p><span class="math display">\[
B_0y_t =
\begin{bmatrix}
a_{11} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
a_{21} &amp; a_{22} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
a_{31} &amp; a_{32} &amp; a_{33} &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
a_{41} &amp; a_{42} &amp; a_{43} &amp; a_{44} &amp; 0 &amp; 0 &amp; 0 \\
a_{51} &amp; a_{52} &amp; a_{53} &amp; a_{54} &amp; a_{55} &amp; 0 &amp; 0 \\
a_{61} &amp; a_{62} &amp; a_{63} &amp; a_{64} &amp; a_{65} &amp; a_{66} &amp; 0 \\
a_{71} &amp; a_{72} &amp; a_{73} &amp; a_{74} &amp; a_{75} &amp; a_{76} &amp; a_{77}\\
\end{bmatrix}
\begin{bmatrix}
com_t \\
usgdp_t \\
gdp_t \\
\pi_t \\
i_t \\
credit_t \\
ex_t \\
\end{bmatrix}
\]</span></p>
<section id="empirical-investigation-for-model-without-deposit-case-3" class="level2">
<h2 class="anchored" data-anchor-id="empirical-investigation-for-model-without-deposit-case-3">Empirical Investigation for model without deposit (case 3)</h2>
<p>As we see the figure of response function of banks credit to cash rate shock, banks credit decreases less upon a positive cash rate shock in the model without banks’ deposit. Another interesting observation is that GDP also decreases less under this model than it did in baseline model in which deposit is included. In other words, GDP, a real economy variable, and credit, a financial economy variable are both responding more sensitively to monetary policy shock when deposit is included in the model.</p>
<section id="figure-8.-irf-to-cash-rate-shock-for-kappa_1-1-plots" class="level6" style="text-align: center;">
<h6 style="text-align: center;" class="anchored" data-anchor-id="figure-8.-irf-to-cash-rate-shock-for-kappa_1-1-plots">Figure 8. IRF to cash rate shock for <span class="math inline">\(\kappa_1\)</span> = 1 plots</h6>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/irf-au-mps plots2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="figure-9.-fevd-of-banks-credit-plots" class="level6" style="text-align: center;">
<h6 style="text-align: center;" class="anchored" data-anchor-id="figure-9.-fevd-of-banks-credit-plots">Figure 9. FEVD of banks’ credit plots</h6>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/fevd-credit plots2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="extension-1.-stochastic-volatility-heteroskedasticity" class="level1">
<h1>Extension 1. Stochastic volatility heteroskedasticity</h1>
<section id="model-equations" class="level2">
<h2 class="anchored" data-anchor-id="model-equations">Model equations</h2>
<p><span class="math display">\[
Y = X\alpha + E
\]</span> <span class="math display">\[
E|X \sim MN(0_{T\times N},\Sigma,diag(h))
\]</span></p>
<p><span class="math display">\[
h = (h_1,...,h_T)'
\]</span> <span class="math display">\[
\sigma^2 = (exp\{h_1\}, ... , exp\{h_t\})
\]</span> <span class="math inline">\(h_t\)</span> - follows a Stochastic Volatility process</p>
<p>The likelihood function is then <span class="math display">\[
L(\alpha,\Sigma|Y,X,h) = det(diag(h)^{-N/2}det(\Sigma)^{-T/2}\times exp\{  -1/2 [\Sigma ^ {-1} (Y-\alpha X)' diag(h)^{-1}(Y-\alpha X)] \}
\]</span> The full conditional posterior distribution for <span class="math inline">\(\alpha,\Sigma\)</span> is given by <span class="math display">\[
P(\alpha,\Sigma|Y,X,h) = MN (\bar{\alpha},\bar{V},\bar{S},\bar{\nu})
\]</span> where <span class="math display">\[
\bar{V}=(X'diag(h)^{-1}X+\underline{V}^{-1})^{-1}
\]</span> <span class="math display">\[
\bar{\alpha}=\bar{V}(X'diag(h)^{-1}Y+\underline{V}^{-1}\underline{\alpha})
\]</span> <span class="math display">\[
\bar{S}=\underline{V}+Y'diag(h)^{-1}Y+\underline{\alpha'}\underline{V}^{-1}\underline{\alpha}-\bar{\alpha'}\bar{V}^{-1}\bar{\alpha}
\]</span> <span class="math display">\[
\bar{\nu}= T + \underline{\nu}
\]</span></p>
</section>
<section id="gibbs-sampler" class="level2">
<h2 class="anchored" data-anchor-id="gibbs-sampler">Gibbs sampler</h2>
<p>At each iteration s:</p>
<p>Step 1. Sample <span class="math inline">\(h^{S}\)</span> from the distribution <span class="math inline">\(P(h|Y,X,A, \Sigma)\)</span> Step 2. Sample <span class="math inline">\(\alpha^{S},\Sigma^{s}\)</span> from the <span class="math inline">\(P(A,\Sigma|Y,X,h) = MN (\bar{\alpha},\bar{V},\bar{S},\bar{\nu})\)</span></p>
<p>Return <span class="math inline">\(\{\alpha^{S},\Sigma^{S},h^{S}]\}_{s=1}^S\)</span></p>
<p>Technics for sampling h is listed in the previous section.</p>
<p>Then it follows that <span class="math inline">\(\bar{V} = (X'diag(h)^{-1}X + \underline{V}^{-1})^{-1}\)</span> <span class="math inline">\(\bar{A} = \bar{V}(X'diag(h)^{-1}Y + \underline{V}^{-1}\underline{A})^{-1}\)</span> <span class="math inline">\(\bar{S} = \underline{S} + Y'diag(h)^{-1}Y + \underline{A}'\underline{V}^{-1}\underline{A} - \bar{A}'\bar{V}^{-1}\bar{A}\)</span> <span class="math inline">\(\bar{\nu}=T + \underline{\nu}\)</span>.</p>
</section>
<section id="algorithm" class="level2">
<h2 class="anchored" data-anchor-id="algorithm">Algorithm</h2>
<p>Following is the algorithm for the part above to sample draws from full conditional posterior distribution. For each iteration, it draws h from a corresponding distribution and then using h, and then draws A and sigma from a multivariate normal distribution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>SVcommon.Gibbs.iteration <span class="ot">=</span> <span class="cf">function</span>(S,aux, priors){</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># aux is a list containing:</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   Y - a TxN matrix</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   X - a TxK matrix</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   H - a Tx1 matrix</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   h0 - a scalar</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   sigma.v2 - a scalar</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   s - a Tx1 matrix</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   A - a KxN matrix</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   Sigma - an NxN matrix</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   sigma2 - a Tx1 matrix</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># priors is a list containing:</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   h0.v - a positive scalar</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   h0.m - a scalar</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   sigmav.s - a positive scalar</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   sigmav.nu - a positive scalar</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   HH - a TxT matrix</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>  T             <span class="ot">=</span> <span class="fu">dim</span>(aux<span class="sc">$</span>Y)[<span class="dv">1</span>]</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>  N             <span class="ot">=</span> <span class="fu">dim</span>(aux<span class="sc">$</span>Y)[<span class="dv">2</span>]</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>  K             <span class="ot">=</span> <span class="fu">dim</span>(X)[<span class="dv">2</span>]</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>  alpha.st      <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">1.92677</span>,<span class="fl">1.34744</span>,<span class="fl">0.73504</span>,<span class="fl">0.02266</span>,<span class="dv">0</span><span class="fl">-0.85173</span>,<span class="sc">-</span><span class="fl">1.97278</span>,<span class="sc">-</span><span class="fl">3.46788</span>,<span class="sc">-</span><span class="fl">5.55246</span>,<span class="sc">-</span><span class="fl">8.68384</span>,<span class="sc">-</span><span class="fl">14.65000</span>)</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>  sigma.st      <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.11265</span>,<span class="fl">0.17788</span>,<span class="fl">0.26768</span>,<span class="fl">0.40611</span>,<span class="fl">0.62699</span>,<span class="fl">0.98583</span>,<span class="fl">1.57469</span>,<span class="fl">2.54498</span>,<span class="fl">4.16591</span>,<span class="fl">7.33342</span>)</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>  pi.st         <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.00609</span>,<span class="fl">0.04775</span>,<span class="fl">0.13057</span>,<span class="fl">0.20674</span>,<span class="fl">0.22715</span>,<span class="fl">0.18842</span>,<span class="fl">0.12047</span>,<span class="fl">0.05591</span>,<span class="fl">0.01575</span>,<span class="fl">0.00115</span>)</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>  Lambda        <span class="ot">=</span> <span class="fu">solve</span>(<span class="fu">chol</span>(aux<span class="sc">$</span>Sigma))</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>  Z             <span class="ot">=</span> <span class="fu">rowSums</span>( ( aux<span class="sc">$</span>Y <span class="sc">-</span> aux<span class="sc">$</span>X <span class="sc">%*%</span> aux<span class="sc">$</span>A ) <span class="sc">%*%</span> Lambda ) <span class="sc">/</span> <span class="fu">sqrt</span>(N)</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>  Y.tilde       <span class="ot">=</span> <span class="fu">as.vector</span>(<span class="fu">log</span>((Z <span class="sc">+</span> <span class="fl">0.0000001</span>)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>  Ytilde.alpha  <span class="ot">=</span> <span class="fu">as.matrix</span>(Y.tilde <span class="sc">-</span> alpha.st[<span class="fu">as.vector</span>(aux<span class="sc">$</span>s)])</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sampling A and Sigma</span></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>  kappa<span class="fl">.1</span>     <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>  kappa<span class="fl">.2</span>     <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>  kappa<span class="fl">.3</span>     <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>  V.prior     <span class="ot">=</span> <span class="fu">diag</span>(<span class="fu">c</span>(kappa<span class="fl">.2</span>,kappa<span class="fl">.1</span><span class="sc">*</span>((<span class="dv">1</span><span class="sc">:</span>p)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">2</span>))<span class="sc">%x%</span><span class="fu">rep</span>(<span class="dv">1</span>,N)))</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>  nu.prior    <span class="ot">=</span> N<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># normal-inverse Wishard posterior parameters</span></span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################</span></span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>  V.bar.inv   <span class="ot">=</span> <span class="fu">t</span>(aux<span class="sc">$</span>X)<span class="sc">%*%</span><span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">as.vector</span>(aux<span class="sc">$</span>sigma2))<span class="sc">%*%</span>aux<span class="sc">$</span>X <span class="sc">+</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(V.prior))</span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>  V.bar       <span class="ot">=</span> <span class="fu">solve</span>(V.bar.inv)</span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>  A.bar       <span class="ot">=</span> V.bar<span class="sc">%*%</span>(<span class="fu">t</span>(aux<span class="sc">$</span>X)<span class="sc">%*%</span>aux<span class="sc">$</span>Y <span class="sc">+</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(V.prior))<span class="sc">%*%</span>aux<span class="sc">$</span>A)</span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>  nu.bar      <span class="ot">=</span> <span class="fu">nrow</span>(aux<span class="sc">$</span>Y) <span class="sc">+</span> nu.prior</span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>  S.bar       <span class="ot">=</span> aux<span class="sc">$</span>Sigma <span class="sc">+</span> <span class="fu">t</span>(aux<span class="sc">$</span>Y)<span class="sc">%*%</span>aux<span class="sc">$</span>Y <span class="sc">+</span> <span class="fu">t</span>(A.prior)<span class="sc">%*%</span><span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(V.prior))<span class="sc">%*%</span>aux<span class="sc">$</span>A <span class="sc">-</span> <span class="fu">t</span>(A.bar)<span class="sc">%*%</span>V.bar.inv<span class="sc">%*%</span>A.bar</span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>  S.bar.inv   <span class="ot">=</span> <span class="fu">solve</span>(S.bar)</span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>  <span class="co"># posterior draws </span></span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################</span></span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a>  Sigma.posterior.IW     <span class="ot">=</span> <span class="fu">rWishart</span>(<span class="dv">1</span>, <span class="at">df=</span>nu.bar, <span class="at">Sigma=</span>S.bar.inv)</span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a>  Sigma.posterior.draw   <span class="ot">=</span> <span class="fu">apply</span>(Sigma.posterior.IW, <span class="dv">3</span> ,solve)</span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a>  aux<span class="sc">$</span>Sigma              <span class="ot">=</span> <span class="fu">array</span>(Sigma.posterior.draw,<span class="fu">c</span>(N,N,<span class="dv">1</span>))</span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a>  A.norm                 <span class="ot">=</span> <span class="fu">array</span>(<span class="fu">rnorm</span>(<span class="fu">prod</span>(<span class="fu">c</span>(K,N,<span class="dv">1</span>))),<span class="fu">c</span>(K,N,<span class="dv">1</span>))</span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a>  L                      <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">chol</span>(V.bar))</span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a>  aux<span class="sc">$</span>A                  <span class="ot">=</span> A.bar <span class="sc">+</span> L<span class="sc">%*%</span>A.norm[,,<span class="dv">1</span>]<span class="sc">%*%</span><span class="fu">chol</span>(aux<span class="sc">$</span>Sigma[,,<span class="dv">1</span>])</span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sampling initial condition</span></span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################</span></span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a>  V.h0.bar      <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span>((<span class="dv">1</span> <span class="sc">/</span> priors<span class="sc">$</span>h0.v) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> aux<span class="sc">$</span>sigma.v2))</span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true" tabindex="-1"></a>  m.h0.bar      <span class="ot">=</span> V.h0.bar<span class="sc">*</span>((priors<span class="sc">$</span>h0.m <span class="sc">/</span> priors<span class="sc">$</span>h0.v) <span class="sc">+</span> (aux<span class="sc">$</span>H[<span class="dv">1</span>] <span class="sc">/</span> aux<span class="sc">$</span>sigma.v2))</span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true" tabindex="-1"></a>  h0.draw       <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> m.h0.bar, <span class="at">sd =</span> <span class="fu">sqrt</span>(V.h0.bar))</span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true" tabindex="-1"></a>  aux<span class="sc">$</span>h0        <span class="ot">=</span> h0.draw</span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sampling sigma.v2</span></span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################</span></span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true" tabindex="-1"></a>  sigma.v2.s    <span class="ot">=</span> priors<span class="sc">$</span>sigmav.s <span class="sc">+</span> <span class="fu">sum</span>(<span class="fu">c</span>(aux<span class="sc">$</span>H[<span class="dv">1</span>] <span class="sc">-</span> aux<span class="sc">$</span>h0, <span class="fu">diff</span>(aux<span class="sc">$</span>H))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true" tabindex="-1"></a>  sigma.v2.draw <span class="ot">=</span> sigma.v2.s <span class="sc">/</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, priors<span class="sc">$</span>sigmav.nu <span class="sc">+</span> T)</span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true" tabindex="-1"></a>  aux<span class="sc">$</span>sigma.v2  <span class="ot">=</span> sigma.v2.draw</span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-79"><a href="#cb9-79" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sampling auxiliary states</span></span>
<span id="cb9-80"><a href="#cb9-80" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################</span></span>
<span id="cb9-81"><a href="#cb9-81" aria-hidden="true" tabindex="-1"></a>  Pr.tmp        <span class="ot">=</span> <span class="fu">simplify2array</span>(<span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="cf">function</span>(x){</span>
<span id="cb9-82"><a href="#cb9-82" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dnorm</span>(Y.tilde, <span class="at">mean =</span> <span class="fu">as.vector</span>(aux<span class="sc">$</span>H <span class="sc">+</span> alpha.st[x]), <span class="at">sd =</span> <span class="fu">sqrt</span>(sigma.st[x]), <span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">log</span>(pi.st[x])</span>
<span id="cb9-83"><a href="#cb9-83" aria-hidden="true" tabindex="-1"></a>  }))</span>
<span id="cb9-84"><a href="#cb9-84" aria-hidden="true" tabindex="-1"></a>  Pr            <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">apply</span>(Pr.tmp, <span class="dv">1</span>, <span class="cf">function</span>(x){<span class="fu">exp</span>(x <span class="sc">-</span> <span class="fu">max</span>(x)) <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">exp</span>(x <span class="sc">-</span> <span class="fu">max</span>(x)))}))</span>
<span id="cb9-85"><a href="#cb9-85" aria-hidden="true" tabindex="-1"></a>  s.cum         <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">apply</span>(Pr, <span class="dv">1</span>, cumsum))</span>
<span id="cb9-86"><a href="#cb9-86" aria-hidden="true" tabindex="-1"></a>  r             <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="fu">runif</span>(T), <span class="dv">10</span>), <span class="at">ncol =</span> <span class="dv">10</span>)</span>
<span id="cb9-87"><a href="#cb9-87" aria-hidden="true" tabindex="-1"></a>  ss            <span class="ot">=</span> <span class="fu">apply</span>(s.cum <span class="sc">&lt;</span> r, <span class="dv">1</span>, sum) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb9-88"><a href="#cb9-88" aria-hidden="true" tabindex="-1"></a>  aux<span class="sc">$</span>s         <span class="ot">=</span> <span class="fu">as.matrix</span>(ss)</span>
<span id="cb9-89"><a href="#cb9-89" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-90"><a href="#cb9-90" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-91"><a href="#cb9-91" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sampling log-volatilities using functions for tridiagonal precision matrix</span></span>
<span id="cb9-92"><a href="#cb9-92" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################</span></span>
<span id="cb9-93"><a href="#cb9-93" aria-hidden="true" tabindex="-1"></a>  Sigma.s.inv   <span class="ot">=</span> <span class="fu">diag</span>(<span class="dv">1</span> <span class="sc">/</span> sigma.st[<span class="fu">as.vector</span>(aux<span class="sc">$</span>s)])</span>
<span id="cb9-94"><a href="#cb9-94" aria-hidden="true" tabindex="-1"></a>  D.inv         <span class="ot">=</span> Sigma.s.inv <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> aux<span class="sc">$</span>sigma.v2) <span class="sc">*</span> priors<span class="sc">$</span>HH</span>
<span id="cb9-95"><a href="#cb9-95" aria-hidden="true" tabindex="-1"></a>  b             <span class="ot">=</span> <span class="fu">as.matrix</span>(Ytilde.alpha <span class="sc">/</span> sigma.st[<span class="fu">as.vector</span>(aux<span class="sc">$</span>s)] <span class="sc">+</span> (aux<span class="sc">$</span>h0<span class="sc">/</span>aux<span class="sc">$</span>sigma.v2)<span class="sc">*</span><span class="fu">diag</span>(T)[,<span class="dv">1</span>])</span>
<span id="cb9-96"><a href="#cb9-96" aria-hidden="true" tabindex="-1"></a>  lead.diag     <span class="ot">=</span> <span class="fu">diag</span>(D.inv)</span>
<span id="cb9-97"><a href="#cb9-97" aria-hidden="true" tabindex="-1"></a>  sub.diag      <span class="ot">=</span> mgcv<span class="sc">::</span><span class="fu">sdiag</span>(D.inv, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb9-98"><a href="#cb9-98" aria-hidden="true" tabindex="-1"></a>  D.chol        <span class="ot">=</span> mgcv<span class="sc">::</span><span class="fu">trichol</span>(<span class="at">ld =</span> lead.diag, <span class="at">sd =</span> sub.diag)</span>
<span id="cb9-99"><a href="#cb9-99" aria-hidden="true" tabindex="-1"></a>  D.L           <span class="ot">=</span> <span class="fu">diag</span>(D.chol<span class="sc">$</span>ld)</span>
<span id="cb9-100"><a href="#cb9-100" aria-hidden="true" tabindex="-1"></a>  mgcv<span class="sc">::</span><span class="fu">sdiag</span>(D.L,<span class="sc">-</span><span class="dv">1</span>) <span class="ot">=</span> D.chol<span class="sc">$</span>sd</span>
<span id="cb9-101"><a href="#cb9-101" aria-hidden="true" tabindex="-1"></a>  x             <span class="ot">=</span> <span class="fu">as.matrix</span>(<span class="fu">rnorm</span>(T))</span>
<span id="cb9-102"><a href="#cb9-102" aria-hidden="true" tabindex="-1"></a>  a             <span class="ot">=</span> <span class="fu">forwardsolve</span>(D.L, b)</span>
<span id="cb9-103"><a href="#cb9-103" aria-hidden="true" tabindex="-1"></a>  draw          <span class="ot">=</span> <span class="fu">backsolve</span>(<span class="fu">t</span>(D.L), a <span class="sc">+</span> x)</span>
<span id="cb9-104"><a href="#cb9-104" aria-hidden="true" tabindex="-1"></a>  aux<span class="sc">$</span>H         <span class="ot">=</span> <span class="fu">as.matrix</span>(draw)</span>
<span id="cb9-105"><a href="#cb9-105" aria-hidden="true" tabindex="-1"></a>  aux<span class="sc">$</span>sigma2    <span class="ot">=</span> <span class="fu">as.matrix</span>(<span class="fu">exp</span>(draw))</span>
<span id="cb9-106"><a href="#cb9-106" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-107"><a href="#cb9-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-108"><a href="#cb9-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-109"><a href="#cb9-109" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-110"><a href="#cb9-110" aria-hidden="true" tabindex="-1"></a>  posteriors      <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb9-111"><a href="#cb9-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">H           =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,T,S),</span>
<span id="cb9-112"><a href="#cb9-112" aria-hidden="true" tabindex="-1"></a>    <span class="at">sigma2      =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,T,S),</span>
<span id="cb9-113"><a href="#cb9-113" aria-hidden="true" tabindex="-1"></a>    <span class="at">s           =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,T,S),</span>
<span id="cb9-114"><a href="#cb9-114" aria-hidden="true" tabindex="-1"></a>    <span class="at">h0          =</span> <span class="fu">rep</span>(<span class="cn">NA</span>,S),</span>
<span id="cb9-115"><a href="#cb9-115" aria-hidden="true" tabindex="-1"></a>    <span class="at">sigma.v2    =</span> <span class="fu">rep</span>(<span class="cn">NA</span>,S),</span>
<span id="cb9-116"><a href="#cb9-116" aria-hidden="true" tabindex="-1"></a>    <span class="at">A           =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="fu">c</span>(K,N,S)),</span>
<span id="cb9-117"><a href="#cb9-117" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sigma       =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="fu">c</span>(N,N,S))</span>
<span id="cb9-118"><a href="#cb9-118" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-119"><a href="#cb9-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-120"><a href="#cb9-120" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>S){</span>
<span id="cb9-121"><a href="#cb9-121" aria-hidden="true" tabindex="-1"></a>      posteriors<span class="sc">$</span>H[,s]             <span class="ot">=</span> aux<span class="sc">$</span>H</span>
<span id="cb9-122"><a href="#cb9-122" aria-hidden="true" tabindex="-1"></a>      posteriors<span class="sc">$</span>sigma2[,s]        <span class="ot">=</span> aux<span class="sc">$</span>sigma2</span>
<span id="cb9-123"><a href="#cb9-123" aria-hidden="true" tabindex="-1"></a>      posteriors<span class="sc">$</span>s[,s]             <span class="ot">=</span> aux<span class="sc">$</span>s</span>
<span id="cb9-124"><a href="#cb9-124" aria-hidden="true" tabindex="-1"></a>      posteriors<span class="sc">$</span>h0[s]             <span class="ot">=</span> aux<span class="sc">$</span>h0</span>
<span id="cb9-125"><a href="#cb9-125" aria-hidden="true" tabindex="-1"></a>      posteriors<span class="sc">$</span>sigma.v2[s]       <span class="ot">=</span> aux<span class="sc">$</span>sigma.v2</span>
<span id="cb9-126"><a href="#cb9-126" aria-hidden="true" tabindex="-1"></a>      posteriors<span class="sc">$</span>A[,,s]            <span class="ot">=</span> aux<span class="sc">$</span>A</span>
<span id="cb9-127"><a href="#cb9-127" aria-hidden="true" tabindex="-1"></a>      posteriors<span class="sc">$</span>Sigma[,,s]        <span class="ot">=</span> aux<span class="sc">$</span>Sigma</span>
<span id="cb9-128"><a href="#cb9-128" aria-hidden="true" tabindex="-1"></a>      posteriors<span class="sc">$</span>A[,,s]            <span class="ot">=</span> aux<span class="sc">$</span>A</span>
<span id="cb9-129"><a href="#cb9-129" aria-hidden="true" tabindex="-1"></a>      posteriors<span class="sc">$</span>Sigma[,,s]        <span class="ot">=</span> aux<span class="sc">$</span>Sigma</span>
<span id="cb9-130"><a href="#cb9-130" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-131"><a href="#cb9-131" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-132"><a href="#cb9-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-133"><a href="#cb9-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(posteriors)</span>
<span id="cb9-134"><a href="#cb9-134" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="extension-2.-estimation-of-hyperparameters" class="level1">
<h1>Extension 2. Estimation of hyperparameters</h1>
<p>Estimating hyperparameters for the prior distribution from data can provide some advantages. By estimating the hyperparameters from data, we can expect that the prior distribution gets more data-driven since it incorporates information specific to the observed dataset. It can lead to more accurate and informative prior for the model. Also, potentially the overall fit of the model can be improved as well. As a second extension, I implement the following hierarchical structure:</p>
<p>Prior for <span class="math inline">\(A\)</span>: <span class="math display">\[A|\Sigma, \kappa \sim \mathcal{MN}_{K \times N}(\underline{A},\Sigma, \kappa^{-1} \underline{V} )\]</span> prior for <span class="math inline">\(\kappa\)</span> <span class="math display">\[\kappa \sim\mathcal{G}(\underline{s}, \underline{a})\]</span> <span class="math inline">\(A\)</span> is assumed to follow a matrix normal distribution, denoted as <span class="math inline">\(\mathcal{MN}_{K\times N}\)</span>, with the following parameters: The mean is <span class="math inline">\(\underline{𝐴}\)</span>, <span class="math inline">\(\Sigma\)</span> is the row specific covariance matrix, and <span class="math inline">\(\kappa^{-1}\underline{V}\)</span> is the column specific covariance matrix.</p>
<p><span class="math inline">\(\kappa\)</span> is a random variable representing a scalar parameter which is assumed to follow a gamma distribution, with the following parameters: <span class="math inline">\(\underline{s}\)</span> is a shape parameter, determining the shape of the gamma distribution, and <span class="math inline">\(\underline{a}\)</span> is a rate parameter, determining the rate or inverse scale of the gamma distribution. These prior distributions capture the assumptions and beliefs about the underlying values of A and <span class="math inline">\(\kappa\)</span> before observing any data.</p>
<section id="derivation-1" class="level2">
<h2 class="anchored" data-anchor-id="derivation-1">Derivation</h2>
<p><span class="math display">\[
\begin{align*}
Y   &amp;= XA + E \\
E|X &amp;\sim \mathcal{MN}_{T \times N}(0_{T \times N},\Sigma,I_T) \\
L(A,\Sigma|Y,X) &amp;\propto det(\Sigma)^{-\frac{T}{2}} exp \left\{-\frac{1}{2} tr \left[ \Sigma^{-1}(Y-XA)'(Y-XA) \right] \right\} \\
                &amp;= det(\Sigma)^{-\frac{T}{2}} exp \left\{-\frac{1}{2} tr \left[ \Sigma^{-1}(A-\hat{A})'X'X(A-\hat{A}) \right] \right\} exp \left\{-\frac{1}{2} tr \left[\Sigma^{-1}(Y-X \hat{A})'(Y-X \hat{A}) \right] \right\} \\
\end{align*}
\]</span></p>
<p>where <span class="math inline">\(\hat{A} = (X'X)^{-1}X'Y\)</span> and it follows that</p>
<p><span class="math display">\[
\begin{align*}
L(A,\Sigma|Y,X) = \mathcal{NIW}_{K\times N}(\hat{A}, \quad (X'X)^{-1},  \quad (Y-X\hat{A})'(Y-X\hat{A}),  \quad T-N-K)
\end{align*}
\]</span></p>
<p>The joint prior distribution for <span class="math inline">\((A, \Sigma)\)</span> of the same form is as follows:</p>
<p><span class="math display">\[
\begin{align*}
p(A,\Sigma) &amp;= p(A|\Sigma) p(\Sigma) \\
A|\Sigma,\kappa &amp;\sim \mathcal{MN}_{K \times N} (\underline{A}, \Sigma , \kappa^{-1}\underline{V}) \\
\Sigma &amp;\sim \mathcal{IW}_{N}(\underline{S},\underline{\nu})
\end{align*}
\]</span></p>
<p>And the full conditional posterior is followed by:</p>
<p><span class="math display">\[
\begin{align*}
p(A,\Sigma |Y, X,\kappa) &amp;= p(A|Y, X, \Sigma) p(\Sigma|Y,X)p(\kappa) \\
p(A|Y,X,\Sigma)   &amp;= \mathcal{MN}_{K \times N} (\bar{A}, \Sigma , \bar{V}) \\
p(\Sigma|Y, X)    &amp;= \mathcal{IW}_{N}(\bar{S},\bar{\nu}) \\
p(\kappa)         &amp;= \mathcal{G}(\underline{s}, \underline{a})
\end{align*}
\]</span></p>
<p>The posterior parameters are given by:</p>
<p><span class="math display">\[
\begin{align*}
\bar{V}      &amp;= (X'X+ \kappa\underline{V}^{-1})^{-1} \\
   \bar{A}   &amp;= \bar{V}(X'Y+\kappa\underline{V}^{-1} \underline{A}) \\
   \bar{\nu} &amp;= T + \underline{\nu} \\
   \bar{S}   &amp;= \underline{S} + Y'Y + \kappa\underline{A}'\underline{V}^{-1}\underline{A} - \bar{A}'\bar{V}^{-1}\bar{A}
\end{align*}
\]</span></p>
</section>
</section>
<section id="extension-3.-implementation-of-the-dummy-initial-observation" class="level1">
<h1>Extension 3. Implementation of the dummy initial observation</h1>
<p>As a third extension, I add the ‘sum of coefficients’ and ‘dummy initial observation’ priors proposed in Doan et al.&nbsp;(1984) and Sims (1993), respectively to my baseline model. Both priors can be implemented by augmenting the system with dummy observations. In more detail, according to the authors, the ‘sum of coefficients’ prior tells that when the average of lagged values of a variable is at some level,it is likely to be a good forecast of future observations, and can be implemented by augmenting the system with the dummy observations.</p>
<p>Necessity of adopting the ‘sum of coefficients’ and ‘dummy initial observation’ is well argued by Carriero and Clark (2015) and Sims (1993). Carriero and Clark (2015) argues that if one decides to estimate the model in levels, which is the case for my model, then these priors implement the belief that there is unit-root in the system, which is a typical feature of macroeconomic datasets. Also, Sims (1993) provides examples that ‘without such elements in the prior, fitted multivariate time series models tend to imply that an unreasonably large share of the sample period variation in the data is accounted for by deterministic components’.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Basic Model Test</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="do">##############################################################################</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>ex2_y <span class="ot">=</span> <span class="fu">apply</span>(<span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">2</span><span class="sc">*</span>S), <span class="at">ncol =</span> <span class="dv">2</span>), <span class="dv">2</span>, cumsum)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>ex2_Y <span class="ot">=</span> ex2_y[<span class="dv">2</span><span class="sc">:</span>S,]</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>ex2_X <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">1</span>, ex2_y[<span class="dv">1</span><span class="sc">:</span>S<span class="dv">-1</span>,])</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>ex2_S <span class="ot">=</span> S</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Prior</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="do">##############</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Setup</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>ex2_N <span class="ot">=</span> <span class="fu">ncol</span>(ex2_Y)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>ex2_p <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>ex2_K <span class="ot">=</span> ex2_N<span class="sc">*</span>ex2_p<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co"># MLE</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>ex2_A.hat       <span class="ot">=</span> <span class="fu">solve</span>(<span class="fu">t</span>(ex2_X)<span class="sc">%*%</span>ex2_X)<span class="sc">%*%</span><span class="fu">t</span>(ex2_X)<span class="sc">%*%</span>ex2_Y</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>ex2_Sigma.hat   <span class="ot">=</span> <span class="fu">t</span>(ex2_Y<span class="sc">-</span>ex2_X<span class="sc">%*%</span>ex2_A.hat)<span class="sc">%*%</span>(ex2_Y<span class="sc">-</span>ex2_X<span class="sc">%*%</span>ex2_A.hat)<span class="sc">/</span><span class="fu">nrow</span>(ex2_Y)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters for prior distribution </span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>ex2_A.prior               <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="fu">nrow</span>(ex2_A.hat),<span class="fu">ncol</span>(ex2_A.hat))</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>ex2_A.prior[<span class="dv">2</span><span class="sc">:</span>(ex2_N<span class="sc">+</span><span class="dv">1</span>),] <span class="ot">=</span> kappa<span class="fl">.3</span><span class="sc">*</span><span class="fu">diag</span>(ex2_N)</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>ex2_V.prior               <span class="ot">=</span> <span class="fu">diag</span>(<span class="fu">c</span>(kappa<span class="fl">.2</span>,kappa<span class="fl">.1</span><span class="sc">*</span>((<span class="dv">1</span><span class="sc">:</span>ex2_p)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">2</span>))<span class="sc">%x%</span><span class="fu">rep</span>(<span class="dv">1</span>,ex2_N)))</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>ex2_S.prior               <span class="ot">=</span> <span class="fu">diag</span>(<span class="fu">diag</span>(ex2_Sigma.hat))</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>ex2_nu.prior              <span class="ot">=</span> ex2_N<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Posterior</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a><span class="do">##############</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a><span class="co"># normal-inverse Wishard posterior parameters</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>ex2_V.bar.inv   <span class="ot">=</span> <span class="fu">t</span>(ex2_X)<span class="sc">%*%</span>ex2_X <span class="sc">+</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(ex2_V.prior))</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>ex2_V.bar       <span class="ot">=</span> <span class="fu">solve</span>(ex2_V.bar.inv)</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>ex2_A.bar       <span class="ot">=</span> ex2_V.bar<span class="sc">%*%</span>(<span class="fu">t</span>(ex2_X)<span class="sc">%*%</span>ex2_Y <span class="sc">+</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(ex2_V.prior))<span class="sc">%*%</span>ex2_A.prior)</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>ex2_nu.bar      <span class="ot">=</span> <span class="fu">nrow</span>(ex2_Y) <span class="sc">+</span> ex2_nu.prior</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>ex2_S.bar       <span class="ot">=</span> ex2_S.prior <span class="sc">+</span> <span class="fu">t</span>(ex2_Y)<span class="sc">%*%</span>ex2_Y <span class="sc">+</span> <span class="fu">t</span>(ex2_A.prior)<span class="sc">%*%</span><span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(ex2_V.prior))<span class="sc">%*%</span>ex2_A.prior <span class="sc">-</span> <span class="fu">t</span>(ex2_A.bar)<span class="sc">%*%</span>ex2_V.bar.inv<span class="sc">%*%</span>ex2_A.bar</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>ex2_S.bar.inv   <span class="ot">=</span> <span class="fu">solve</span>(ex2_S.bar)</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a><span class="co"># posterior draws</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>ex2_Sigma.posterior   <span class="ot">=</span> <span class="fu">rWishart</span>(ex2_S, <span class="at">df=</span>ex2_nu.bar, <span class="at">Sigma=</span>ex2_S.bar.inv)</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>ex2_Sigma.posterior   <span class="ot">=</span> <span class="fu">apply</span>(ex2_Sigma.posterior,<span class="dv">3</span>,solve)</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>ex2_Sigma.posterior   <span class="ot">=</span> <span class="fu">array</span>(ex2_Sigma.posterior,<span class="fu">c</span>(ex2_N,ex2_N,ex2_S))</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>ex2_A.posterior       <span class="ot">=</span> <span class="fu">array</span>(<span class="fu">rnorm</span>(<span class="fu">prod</span>(<span class="fu">c</span>(<span class="fu">dim</span>(ex2_A.bar),ex2_S))),<span class="fu">c</span>(<span class="fu">dim</span>(ex2_A.bar),ex2_S))</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>ex2_B.posterior       <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(ex2_N,ex2_N,ex2_S))</span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>ex2_L                 <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">chol</span>(ex2_V.bar))</span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>ex2_S){</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>  ex2_cholSigma.s     <span class="ot">=</span> <span class="fu">chol</span>(ex2_Sigma.posterior[,,s])</span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>  ex2_B.posterior[,,s]<span class="ot">=</span> <span class="fu">t</span>(ex2_cholSigma.s)</span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>  ex2_A.posterior[,,s]<span class="ot">=</span> ex2_A.bar <span class="sc">+</span> ex2_L<span class="sc">%*%</span>ex2_A.posterior[,,s]<span class="sc">%*%</span>ex2_cholSigma.s</span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a><span class="do">##############################################################################</span></span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a><span class="do">##Extended model Test</span></span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a><span class="do">##############################################################################</span></span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial setup</span></span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a><span class="do">##############</span></span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a>  lambda3       <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a>  lambda4       <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a>  M             <span class="ot">=</span> <span class="dv">1</span><span class="sc">+</span>N<span class="sc">*</span>ex2_p</span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a>  in.obvs.ex2_Y <span class="ot">=</span> <span class="fu">matrix</span>(y[<span class="dv">1</span><span class="sc">:</span>ex2_p,], <span class="at">ncol =</span> <span class="fu">ncol</span>(ex2_y))</span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a>  y_bar         <span class="ot">=</span> <span class="fu">colMeans</span>(in.obvs.ex2_Y)</span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a>  Y_star        <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">diag</span>(y_bar)<span class="sc">/</span>lambda3, y_bar<span class="sc">/</span>lambda4)</span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a>  X_star        <span class="ot">=</span> <span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">ncol</span>(ex2_y)), <span class="dv">1</span><span class="sc">/</span>lambda4))</span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>ex2_p) {</span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a>    X_star      <span class="ot">=</span> <span class="fu">cbind</span>(Y_star, X_star)</span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a>ex22_X          <span class="ot">=</span> <span class="fu">rbind</span>(X_star, ex2_X)</span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a>ex22_Y          <span class="ot">=</span> <span class="fu">rbind</span>(Y_star, ex2_Y)</span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-80"><a href="#cb10-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-81"><a href="#cb10-81" aria-hidden="true" tabindex="-1"></a><span class="co"># Prior</span></span>
<span id="cb10-82"><a href="#cb10-82" aria-hidden="true" tabindex="-1"></a><span class="do">##############</span></span>
<span id="cb10-83"><a href="#cb10-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-84"><a href="#cb10-84" aria-hidden="true" tabindex="-1"></a><span class="co"># Setup</span></span>
<span id="cb10-85"><a href="#cb10-85" aria-hidden="true" tabindex="-1"></a>ex22_N <span class="ot">=</span> <span class="fu">ncol</span>(ex22_Y)</span>
<span id="cb10-86"><a href="#cb10-86" aria-hidden="true" tabindex="-1"></a>ex22_p <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb10-87"><a href="#cb10-87" aria-hidden="true" tabindex="-1"></a>ex22_K <span class="ot">=</span> ex22_N<span class="sc">*</span>ex22_p<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb10-88"><a href="#cb10-88" aria-hidden="true" tabindex="-1"></a>ex22_S <span class="ot">=</span> <span class="dv">1000</span>  </span>
<span id="cb10-89"><a href="#cb10-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-90"><a href="#cb10-90" aria-hidden="true" tabindex="-1"></a><span class="co"># MLE</span></span>
<span id="cb10-91"><a href="#cb10-91" aria-hidden="true" tabindex="-1"></a>ex22_A.hat       <span class="ot">=</span> <span class="fu">solve</span>(<span class="fu">t</span>(ex22_X)<span class="sc">%*%</span>ex22_X)<span class="sc">%*%</span><span class="fu">t</span>(ex22_X)<span class="sc">%*%</span>ex22_Y</span>
<span id="cb10-92"><a href="#cb10-92" aria-hidden="true" tabindex="-1"></a>ex22_Sigma.hat   <span class="ot">=</span> <span class="fu">t</span>(ex22_Y<span class="sc">-</span>ex22_X<span class="sc">%*%</span>ex22_A.hat)<span class="sc">%*%</span>(ex22_Y<span class="sc">-</span>ex22_X<span class="sc">%*%</span>ex22_A.hat)<span class="sc">/</span><span class="fu">nrow</span>(ex22_Y)</span>
<span id="cb10-93"><a href="#cb10-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-94"><a href="#cb10-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-95"><a href="#cb10-95" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters for prior distribution </span></span>
<span id="cb10-96"><a href="#cb10-96" aria-hidden="true" tabindex="-1"></a>ex22_A.prior                <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="fu">nrow</span>(ex22_A.hat),<span class="fu">ncol</span>(ex22_A.hat))</span>
<span id="cb10-97"><a href="#cb10-97" aria-hidden="true" tabindex="-1"></a>ex22_A.prior[<span class="dv">2</span><span class="sc">:</span>(ex22_N<span class="sc">+</span><span class="dv">1</span>),] <span class="ot">=</span> kappa<span class="fl">.3</span><span class="sc">*</span><span class="fu">diag</span>(ex22_N)</span>
<span id="cb10-98"><a href="#cb10-98" aria-hidden="true" tabindex="-1"></a>ex22_V.prior                <span class="ot">=</span> <span class="fu">diag</span>(<span class="fu">c</span>(kappa<span class="fl">.2</span>,kappa<span class="fl">.1</span><span class="sc">*</span>((<span class="dv">1</span><span class="sc">:</span>ex22_p)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">2</span>))<span class="sc">%x%</span><span class="fu">rep</span>(<span class="dv">1</span>,ex22_N)))</span>
<span id="cb10-99"><a href="#cb10-99" aria-hidden="true" tabindex="-1"></a>ex22_S.prior                <span class="ot">=</span> <span class="fu">diag</span>(<span class="fu">diag</span>(ex22_Sigma.hat))</span>
<span id="cb10-100"><a href="#cb10-100" aria-hidden="true" tabindex="-1"></a>ex22_nu.prior               <span class="ot">=</span> ex22_N<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb10-101"><a href="#cb10-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-102"><a href="#cb10-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-103"><a href="#cb10-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-104"><a href="#cb10-104" aria-hidden="true" tabindex="-1"></a><span class="co"># Porterior</span></span>
<span id="cb10-105"><a href="#cb10-105" aria-hidden="true" tabindex="-1"></a><span class="do">##############</span></span>
<span id="cb10-106"><a href="#cb10-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-107"><a href="#cb10-107" aria-hidden="true" tabindex="-1"></a><span class="co"># normal-inverse Wishard posterior parameters</span></span>
<span id="cb10-108"><a href="#cb10-108" aria-hidden="true" tabindex="-1"></a>ex22_V.bar.inv   <span class="ot">=</span> <span class="fu">t</span>(ex22_X)<span class="sc">%*%</span>ex22_X <span class="sc">+</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(ex22_V.prior))</span>
<span id="cb10-109"><a href="#cb10-109" aria-hidden="true" tabindex="-1"></a>ex22_V.bar       <span class="ot">=</span> <span class="fu">solve</span>(ex22_V.bar.inv)</span>
<span id="cb10-110"><a href="#cb10-110" aria-hidden="true" tabindex="-1"></a>ex22_A.bar       <span class="ot">=</span> ex22_V.bar<span class="sc">%*%</span>(<span class="fu">t</span>(ex22_X)<span class="sc">%*%</span>ex22_Y <span class="sc">+</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(ex22_V.prior))<span class="sc">%*%</span>ex22_A.prior)</span>
<span id="cb10-111"><a href="#cb10-111" aria-hidden="true" tabindex="-1"></a>ex22_nu.bar      <span class="ot">=</span> <span class="fu">nrow</span>(ex22_Y) <span class="sc">+</span> ex22_nu.prior</span>
<span id="cb10-112"><a href="#cb10-112" aria-hidden="true" tabindex="-1"></a>ex22_S.bar       <span class="ot">=</span> ex22_S.prior <span class="sc">+</span> <span class="fu">t</span>(ex22_Y)<span class="sc">%*%</span>ex22_Y <span class="sc">+</span> <span class="fu">t</span>(ex22_A.prior)<span class="sc">%*%</span><span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(ex22_V.prior))<span class="sc">%*%</span>ex22_A.prior <span class="sc">-</span> <span class="fu">t</span>(ex22_A.bar)<span class="sc">%*%</span>ex22_V.bar.inv<span class="sc">%*%</span>ex22_A.bar</span>
<span id="cb10-113"><a href="#cb10-113" aria-hidden="true" tabindex="-1"></a>ex22_S.bar.inv   <span class="ot">=</span> <span class="fu">solve</span>(ex22_S.bar)</span>
<span id="cb10-114"><a href="#cb10-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-115"><a href="#cb10-115" aria-hidden="true" tabindex="-1"></a><span class="co"># posterior draws</span></span>
<span id="cb10-116"><a href="#cb10-116" aria-hidden="true" tabindex="-1"></a>ex22_Sigma.posterior   <span class="ot">=</span> <span class="fu">rWishart</span>(ex22_S, <span class="at">df=</span>ex22_nu.bar, <span class="at">Sigma=</span>ex22_S.bar.inv)</span>
<span id="cb10-117"><a href="#cb10-117" aria-hidden="true" tabindex="-1"></a>ex22_Sigma.posterior   <span class="ot">=</span> <span class="fu">apply</span>(ex22_Sigma.posterior,<span class="dv">3</span>,solve)</span>
<span id="cb10-118"><a href="#cb10-118" aria-hidden="true" tabindex="-1"></a>ex22_Sigma.posterior   <span class="ot">=</span> <span class="fu">array</span>(ex22_Sigma.posterior,<span class="fu">c</span>(ex22_N,ex22_N,ex22_S))</span>
<span id="cb10-119"><a href="#cb10-119" aria-hidden="true" tabindex="-1"></a>ex22_A.posterior       <span class="ot">=</span> <span class="fu">array</span>(<span class="fu">rnorm</span>(<span class="fu">prod</span>(<span class="fu">c</span>(<span class="fu">dim</span>(ex22_A.bar),ex22_S))),<span class="fu">c</span>(<span class="fu">dim</span>(ex22_A.bar),ex22_S))</span>
<span id="cb10-120"><a href="#cb10-120" aria-hidden="true" tabindex="-1"></a>ex22_B.posterior       <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(ex22_N,ex22_N,ex22_S))</span>
<span id="cb10-121"><a href="#cb10-121" aria-hidden="true" tabindex="-1"></a>ex22_L                 <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">chol</span>(ex22_V.bar))</span>
<span id="cb10-122"><a href="#cb10-122" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>ex22_S){</span>
<span id="cb10-123"><a href="#cb10-123" aria-hidden="true" tabindex="-1"></a>  ex22_cholSigma.s     <span class="ot">=</span> <span class="fu">chol</span>(ex22_Sigma.posterior[,,s])</span>
<span id="cb10-124"><a href="#cb10-124" aria-hidden="true" tabindex="-1"></a>  ex22_B.posterior[,,s]<span class="ot">=</span> <span class="fu">t</span>(ex22_cholSigma.s)</span>
<span id="cb10-125"><a href="#cb10-125" aria-hidden="true" tabindex="-1"></a>  ex22_A.posterior[,,s]<span class="ot">=</span> ex22_A.bar <span class="sc">+</span> ex22_L<span class="sc">%*%</span>ex22_A.posterior[,,s]<span class="sc">%*%</span>ex22_cholSigma.s</span>
<span id="cb10-126"><a href="#cb10-126" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-127"><a href="#cb10-127" aria-hidden="true" tabindex="-1"></a><span class="do">##############################################################################</span></span>
<span id="cb10-128"><a href="#cb10-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-129"><a href="#cb10-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-130"><a href="#cb10-130" aria-hidden="true" tabindex="-1"></a><span class="co"># Derivation of A.posterior and B.posterior for extened model</span></span>
<span id="cb10-131"><a href="#cb10-131" aria-hidden="true" tabindex="-1"></a><span class="do">##############</span></span>
<span id="cb10-132"><a href="#cb10-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-133"><a href="#cb10-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-134"><a href="#cb10-134" aria-hidden="true" tabindex="-1"></a>  ex23_in.obvs.Y             <span class="ot">=</span> <span class="fu">matrix</span>(y[<span class="dv">1</span><span class="sc">:</span>p,], <span class="at">ncol =</span> N)</span>
<span id="cb10-135"><a href="#cb10-135" aria-hidden="true" tabindex="-1"></a>  ex23_y.bar                 <span class="ot">=</span> <span class="fu">colMeans</span>(ex23_in.obvs.Y)</span>
<span id="cb10-136"><a href="#cb10-136" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-137"><a href="#cb10-137" aria-hidden="true" tabindex="-1"></a>  ex23_Y_star                <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">diag</span>(ex23_y.bar)<span class="sc">/</span>lambda3, ex23_y.bar<span class="sc">/</span>lambda4)</span>
<span id="cb10-138"><a href="#cb10-138" aria-hidden="true" tabindex="-1"></a>  ex23_X_star                <span class="ot">=</span> <span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, N), <span class="dv">1</span><span class="sc">/</span>lambda4))</span>
<span id="cb10-139"><a href="#cb10-139" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>p) {</span>
<span id="cb10-140"><a href="#cb10-140" aria-hidden="true" tabindex="-1"></a>    ex23_X_star              <span class="ot">=</span> <span class="fu">cbind</span>(ex23_Y_star, ex23_X_star)</span>
<span id="cb10-141"><a href="#cb10-141" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-142"><a href="#cb10-142" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-143"><a href="#cb10-143" aria-hidden="true" tabindex="-1"></a>  ex23_X                     <span class="ot">=</span> <span class="fu">rbind</span>(ex23_X_star, X)</span>
<span id="cb10-144"><a href="#cb10-144" aria-hidden="true" tabindex="-1"></a>  ex23_Y                     <span class="ot">=</span> <span class="fu">rbind</span>(ex23_Y_star, Y)</span>
<span id="cb10-145"><a href="#cb10-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-146"><a href="#cb10-146" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. priors of extension 3</span></span>
<span id="cb10-147"><a href="#cb10-147" aria-hidden="true" tabindex="-1"></a>  ex23_A.hat                 <span class="ot">=</span> <span class="fu">solve</span>(<span class="fu">t</span>(ex23_X)<span class="sc">%*%</span>ex23_X)<span class="sc">%*%</span>(<span class="fu">t</span>(ex23_X)<span class="sc">%*%</span>ex23_Y)</span>
<span id="cb10-148"><a href="#cb10-148" aria-hidden="true" tabindex="-1"></a>  ex23_Sigma.hat             <span class="ot">=</span> <span class="fu">diag</span>(<span class="fu">ncol</span>(ex23_Y))</span>
<span id="cb10-149"><a href="#cb10-149" aria-hidden="true" tabindex="-1"></a>  ex23_N                     <span class="ot">=</span> <span class="fu">ncol</span>(ex23_Y)</span>
<span id="cb10-150"><a href="#cb10-150" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb10-151"><a href="#cb10-151" aria-hidden="true" tabindex="-1"></a>  ex23_A.prior               <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="fu">nrow</span>(ex23_A.hat),<span class="fu">ncol</span>(ex23_A.hat))</span>
<span id="cb10-152"><a href="#cb10-152" aria-hidden="true" tabindex="-1"></a>  ex23_A.prior[<span class="dv">2</span><span class="sc">:</span>(ex23_N<span class="sc">+</span><span class="dv">1</span>),]<span class="ot">=</span> <span class="fu">diag</span>(ex23_N)</span>
<span id="cb10-153"><a href="#cb10-153" aria-hidden="true" tabindex="-1"></a>  ex23_V.prior               <span class="ot">=</span> <span class="fu">diag</span>(<span class="fu">c</span>(kappa<span class="fl">.2</span>,kappa<span class="fl">.1</span><span class="sc">*</span>((<span class="dv">1</span><span class="sc">:</span>p)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">2</span>))<span class="sc">%x%</span><span class="fu">rep</span>(<span class="dv">1</span>,ex23_N)))</span>
<span id="cb10-154"><a href="#cb10-154" aria-hidden="true" tabindex="-1"></a>  ex23_S.prior               <span class="ot">=</span> <span class="fu">diag</span>(<span class="fu">diag</span>(ex23_Sigma.hat))</span>
<span id="cb10-155"><a href="#cb10-155" aria-hidden="true" tabindex="-1"></a>  ex23_nu.prior              <span class="ot">=</span> ex23_N<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb10-156"><a href="#cb10-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-157"><a href="#cb10-157" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. posteriors of extension 3</span></span>
<span id="cb10-158"><a href="#cb10-158" aria-hidden="true" tabindex="-1"></a>  ex23_V.bar.inv             <span class="ot">=</span> (<span class="fu">t</span>(X)<span class="sc">%*%</span>X) <span class="sc">+</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(ex23_V.prior))</span>
<span id="cb10-159"><a href="#cb10-159" aria-hidden="true" tabindex="-1"></a>  ex23_V.bar                 <span class="ot">=</span> <span class="fu">solve</span>(ex23_V.bar.inv)</span>
<span id="cb10-160"><a href="#cb10-160" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-161"><a href="#cb10-161" aria-hidden="true" tabindex="-1"></a>  ex23_A.bar                 <span class="ot">=</span> ex23_V.bar<span class="sc">%*%</span>(<span class="fu">t</span>(X)<span class="sc">%*%</span>Y <span class="sc">+</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(ex23_V.prior))<span class="sc">%*%</span>ex23_A.prior)</span>
<span id="cb10-162"><a href="#cb10-162" aria-hidden="true" tabindex="-1"></a>  ex23_nu.bar                <span class="ot">=</span> <span class="fu">nrow</span>(Y) <span class="sc">+</span> ex23_nu.prior</span>
<span id="cb10-163"><a href="#cb10-163" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-164"><a href="#cb10-164" aria-hidden="true" tabindex="-1"></a>  ex23_S.bar                 <span class="ot">=</span> ex23_S.prior <span class="sc">+</span> <span class="fu">t</span>(Y)<span class="sc">%*%</span>Y <span class="sc">+</span> <span class="fu">t</span>(ex23_A.prior)<span class="sc">%*%</span><span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(ex23_V.prior))<span class="sc">%*%</span>ex23_A.prior <span class="sc">-</span> <span class="fu">t</span>(ex23_A.bar)<span class="sc">%*%</span>ex23_V.bar.inv<span class="sc">%*%</span>ex23_A.bar</span>
<span id="cb10-165"><a href="#cb10-165" aria-hidden="true" tabindex="-1"></a>  ex23_S.bar.inv             <span class="ot">=</span> <span class="fu">solve</span>(ex23_S.bar)</span>
<span id="cb10-166"><a href="#cb10-166" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb10-167"><a href="#cb10-167" aria-hidden="true" tabindex="-1"></a>  ex23_Sigma.posterior.inv   <span class="ot">=</span> <span class="fu">rWishart</span>(S, <span class="at">df=</span>ex23_nu.bar, <span class="at">Sigma=</span>ex23_S.bar.inv)</span>
<span id="cb10-168"><a href="#cb10-168" aria-hidden="true" tabindex="-1"></a>  ex23_Sigma.posterior       <span class="ot">=</span> <span class="fu">apply</span>(ex23_Sigma.posterior.inv,<span class="dv">3</span>,solve)</span>
<span id="cb10-169"><a href="#cb10-169" aria-hidden="true" tabindex="-1"></a>  ex23_Sigma.posterior       <span class="ot">=</span> <span class="fu">array</span>(ex23_Sigma.posterior,<span class="fu">c</span>(N,N,S))</span>
<span id="cb10-170"><a href="#cb10-170" aria-hidden="true" tabindex="-1"></a>  ex23_A.posterior           <span class="ot">=</span> <span class="fu">array</span>(<span class="fu">rnorm</span>(<span class="fu">prod</span>(<span class="fu">c</span>(<span class="fu">dim</span>(ex23_A.bar),S))),<span class="fu">c</span>(<span class="fu">dim</span>(ex23_A.bar),S))</span>
<span id="cb10-171"><a href="#cb10-171" aria-hidden="true" tabindex="-1"></a>  ex23_L                     <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">chol</span>(ex23_V.bar))</span>
<span id="cb10-172"><a href="#cb10-172" aria-hidden="true" tabindex="-1"></a>  ex23_B.posterior           <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="fu">c</span>(N,N,S))</span>
<span id="cb10-173"><a href="#cb10-173" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-174"><a href="#cb10-174" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>S){</span>
<span id="cb10-175"><a href="#cb10-175" aria-hidden="true" tabindex="-1"></a>    ex23_chol.sigma          <span class="ot">=</span> <span class="fu">chol</span>(ex23_Sigma.posterior[,,s])</span>
<span id="cb10-176"><a href="#cb10-176" aria-hidden="true" tabindex="-1"></a>    ex23_A.posterior[,,s]    <span class="ot">=</span> ex23_A.bar <span class="sc">+</span> ex23_L<span class="sc">%*%</span>ex23_A.posterior[,,s]<span class="sc">%*%</span>ex23_chol.sigma</span>
<span id="cb10-177"><a href="#cb10-177" aria-hidden="true" tabindex="-1"></a>    ex23_B.posterior[,,s]    <span class="ot">=</span> <span class="fu">t</span>(ex23_chol.sigma)</span>
<span id="cb10-178"><a href="#cb10-178" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As we see below, the result from the simulation is similar to the true parameter of the baseline model.</p>
<p>A.posterior for basic and extended model:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>       [,1]  [,2]
[1,]  0.094 0.032
[2,]  0.994 0.000
[3,] -0.002 1.000</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>       [,1]   [,2]
[1,]  0.130  0.061
[2,]  0.993 -0.002
[3,] -0.003  0.999</code></pre>
</div>
</div>
<p>B.posterior for basic and extended model:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>       [,1]  [,2]
[1,]  1.000 0.000
[2,] -0.005 1.005</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>       [,1]  [,2]
[1,]  1.009 0.000
[2,] -0.016 1.013</code></pre>
</div>
</div>
<p>Sigma.posterior for basic and extended model:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>       [,1]   [,2]
[1,]  0.999 -0.005
[2,] -0.005  1.011</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>       [,1]   [,2]
[1,]  1.017 -0.016
[2,] -0.016  1.027</code></pre>
</div>
</div>
<section id="empirical-investigation-for-extended-model" class="level2">
<h2 class="anchored" data-anchor-id="empirical-investigation-for-extended-model">Empirical Investigation for extended model</h2>
<p>Now I present the Impulse Response Functions (IRFs) for the extended model below. As we see, the point estimates deviate from zero, and the directions are in accordance with the baseline model. However, except the cash rate, variables do not meaningfully diverge from zero in statistical sense.</p>
<section id="figure-10.-irf-to-cash-rate-shock-for-kappa_1-1-plots" class="level6" style="text-align: center;">
<h6 style="text-align: center;" class="anchored" data-anchor-id="figure-10.-irf-to-cash-rate-shock-for-kappa_1-1-plots">Figure 10. IRF to cash rate shock for <span class="math inline">\(\kappa_1\)</span> = 1 plots</h6>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/irf-au-mps plots for extension 2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>This research aimed to investigate the relationship between monetary policy, banks’ deposits, and credit growth in Australia. The objective was to understand how changes in monetary policy influence banks’ credit together with deposit growth. The study incorporated the deposit channel proposed by <span class="citation" data-cites="drechsler2017deposits">Drechsler, Savov, and Schnabl (<a href="#ref-drechsler2017deposits" role="doc-biblioref">2017</a>)</span> in the SVAR framework to evaluate the effect of monetary policy with deposit changes on banks’ credit. The findings indicate that when deposits are included in the model, banks’ credit decreases more in response to a positive cash rate shock, and GDP exhibits a larger decrease compared to the model without the deposit. These observations highlight the importance of considering the deposit channel in understanding the transmission of monetary policy and its impact on both real and financial economy variables.</p>
</section>
<section id="references" class="level1 unnumbered">




</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-berkelmans2005credit" class="csl-entry" role="listitem">
Berkelmans, Leon, and Leon Berkelmans. 2005. <span>“Credit and Monetary Policy: An Australian SVAR.”</span>
</div>
<div id="ref-bernanke1992federal" class="csl-entry" role="listitem">
Bernanke, Ben, and Alan S Blinder. 1992. <span>“The Federal Funds Rate and the Transmission of Monetary Policy.”</span> <em>American Economic Review</em> 82 (4): 901–21.
</div>
<div id="ref-drechsler2017deposits" class="csl-entry" role="listitem">
Drechsler, Itamar, Alexi Savov, and Philipp Schnabl. 2017. <span>“The Deposits Channel of Monetary Policy.”</span> <em>The Quarterly Journal of Economics</em> 132 (4): 1819–76.
</div>
<div id="ref-jimenez2014hazardous" class="csl-entry" role="listitem">
Gabriel Jiménez, José-Luis Peydró, Steven Ongena. 2014. <span>“Hazardous Times for Monetary Policy: What Do Twenty-Three Million Bank Loans Say about the Effects of Monetary Policy on Credit Risk-Taking?”</span> <em>Econometrica</em> 82 (2): 463–505.
</div>
<div id="ref-woodford2010financial" class="csl-entry" role="listitem">
Woodford, Michael. 2010. <span>“Financial Intermediation and Macroeconomic Analysis.”</span> <em>Journal of Economic Perspectives</em> 24 (4): 21–44.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>